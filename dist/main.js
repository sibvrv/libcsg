/*!
 * LibCSG version 0.8.0
 * Build Date: 2020-05-05T09:24:35.494Z
 * Homepage: https://github.com/sibvrv/libcsg
 * Repository: git+https://github.com/sibvrv/libcsg.git
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.libcsg=t():e.libcsg=t()}(global,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=47)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._CSGDEBUG=!1,t.defaultResolution2D=32,t.defaultResolution3D=12,t.EPS=1e-5,t.angleEPS=.1,t.areaEPS=.5*t.EPS*t.EPS*Math.sin(t.angleEPS),t.all=0,t.top=1,t.bottom=2,t.left=3,t.right=4,t.front=5,t.back=6,t.staticTag=1,t.getTag=function(){return t.staticTag++}},function(e,t,n){const{IsFloat:r}=n(3),o=n(2),i=function(e,t,n){if(3===arguments.length)this._x=parseFloat(e),this._y=parseFloat(t),this._z=parseFloat(n);else if(2===arguments.length)this._x=parseFloat(e),this._y=parseFloat(t),this._z=0;else{var s=!0;if(1===arguments.length)if("object"==typeof e)e instanceof i?(this._x=e._x,this._y=e._y,this._z=e._z):e instanceof o?(this._x=e._x,this._y=e._y,this._z=0):e instanceof Array?e.length<2||e.length>3?s=!1:(this._x=parseFloat(e[0]),this._y=parseFloat(e[1]),3===e.length?this._z=parseFloat(e[2]):this._z=0):"x"in e&&"y"in e?(this._x=parseFloat(e.x),this._y=parseFloat(e.y),this._z="z"in e?parseFloat(e.z):0):"_x"in e&&"_y"in e?(this._x=parseFloat(e._x),this._y=parseFloat(e._y),this._z="_z"in e?parseFloat(e._z):0):s=!1;else{var a=parseFloat(e);this._x=a,this._y=a,this._z=a}else s=!1;if(!s)throw new Error("wrong arguments");r(this._x)&&r(this._y)&&r(this._z)||(s=!1)}};i.Create=function(e,t,n){var r=Object.create(i.prototype);return r._x=e,r._y=t,r._z=n,r},i.prototype={get x(){return this._x},get y(){return this._y},get z(){return this._z},set x(e){throw new Error("Vector3D is immutable")},set y(e){throw new Error("Vector3D is immutable")},set z(e){throw new Error("Vector3D is immutable")},clone:function(){return i.Create(this._x,this._y,this._z)},negated:function(){return i.Create(-this._x,-this._y,-this._z)},abs:function(){return i.Create(Math.abs(this._x),Math.abs(this._y),Math.abs(this._z))},plus:function(e){return i.Create(this._x+e._x,this._y+e._y,this._z+e._z)},minus:function(e){return i.Create(this._x-e._x,this._y-e._y,this._z-e._z)},times:function(e){return i.Create(this._x*e,this._y*e,this._z*e)},dividedBy:function(e){return i.Create(this._x/e,this._y/e,this._z/e)},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z},lerp:function(e,t){return this.plus(e.minus(this).times(t))},lengthSquared:function(){return this.dot(this)},length:function(){return Math.sqrt(this.lengthSquared())},unit:function(){return this.dividedBy(this.length())},cross:function(e){return i.Create(this._y*e._z-this._z*e._y,this._z*e._x-this._x*e._z,this._x*e._y-this._y*e._x)},distanceTo:function(e){return this.minus(e).length()},distanceToSquared:function(e){return this.minus(e).lengthSquared()},equals:function(e){return this._x===e._x&&this._y===e._y&&this._z===e._z},multiply4x4:function(e){return e.leftMultiply1x3Vector(this)},transform:function(e){return e.leftMultiply1x3Vector(this)},toString:function(){return"("+this._x.toFixed(5)+", "+this._y.toFixed(5)+", "+this._z.toFixed(5)+")"},randomNonParallelVector:function(){var e=this.abs();return e._x<=e._y&&e._x<=e._z?i.Create(1,0,0):e._y<=e._x&&e._y<=e._z?i.Create(0,1,0):i.Create(0,0,1)},min:function(e){return i.Create(Math.min(this._x,e._x),Math.min(this._y,e._y),Math.min(this._z,e._z))},max:function(e){return i.Create(Math.max(this._x,e._x),Math.max(this._y,e._y),Math.max(this._z,e._z))}},e.exports=i},function(e,t,n){const{IsFloat:r}=n(3),o=function(e,t){if(2===arguments.length)this._x=parseFloat(e),this._y=parseFloat(t);else{var n=!0;if(1===arguments.length)if("object"==typeof e)e instanceof o?(this._x=e._x,this._y=e._y):e instanceof Array?(this._x=parseFloat(e[0]),this._y=parseFloat(e[1])):"x"in e&&"y"in e?(this._x=parseFloat(e.x),this._y=parseFloat(e.y)):n=!1;else{var i=parseFloat(e);this._x=i,this._y=i}else n=!1;if(n&&(r(this._x)&&r(this._y)||(n=!1)),!n)throw new Error("wrong arguments")}};o.fromAngle=function(e){return o.fromAngleRadians(e)},o.fromAngleDegrees=function(e){var t=Math.PI*e/180;return o.fromAngleRadians(t)},o.fromAngleRadians=function(e){return o.Create(Math.cos(e),Math.sin(e))},o.Create=function(e,t){var n=Object.create(o.prototype);return n._x=e,n._y=t,n},o.prototype={get x(){return this._x},get y(){return this._y},set x(e){throw new Error("Vector2D is immutable")},set y(e){throw new Error("Vector2D is immutable")},toVector3D:function(e){return new(n(1))(this._x,this._y,e)},equals:function(e){return this._x===e._x&&this._y===e._y},clone:function(){return o.Create(this._x,this._y)},negated:function(){return o.Create(-this._x,-this._y)},plus:function(e){return o.Create(this._x+e._x,this._y+e._y)},minus:function(e){return o.Create(this._x-e._x,this._y-e._y)},times:function(e){return o.Create(this._x*e,this._y*e)},dividedBy:function(e){return o.Create(this._x/e,this._y/e)},dot:function(e){return this._x*e._x+this._y*e._y},lerp:function(e,t){return this.plus(e.minus(this).times(t))},length:function(){return Math.sqrt(this.dot(this))},distanceTo:function(e){return this.minus(e).length()},distanceToSquared:function(e){return this.minus(e).lengthSquared()},lengthSquared:function(){return this.dot(this)},unit:function(){return this.dividedBy(this.length())},cross:function(e){return this._x*e._y-this._y*e._x},normal:function(){return o.Create(this._y,-this._x)},multiply4x4:function(e){return e.leftMultiply1x2Vector(this)},transform:function(e){return e.leftMultiply1x2Vector(this)},angle:function(){return this.angleRadians()},angleDegrees:function(){return 180*this.angleRadians()/Math.PI},angleRadians:function(){return Math.atan2(this._y,this._x)},min:function(e){return o.Create(Math.min(this._x,e._x),Math.min(this._y,e._y))},max:function(e){return o.Create(Math.max(this._x,e._x),Math.max(this._y,e._y))},toString:function(){return"("+this._x.toFixed(5)+", "+this._y.toFixed(5)+")"},abs:function(){return o.Create(Math.abs(this._x),Math.abs(this._y))}},e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnNumberSort=function(e,t){return e-t},t.fnSortByIndex=function(e,t){return e.index-t.index},t.IsFloat=function(e){return!isNaN(e)||e===1/0||e===-1/0},t.solve2Linear=function(e,t,n,r,o,i){var s=1/(e*r-t*n),a=o*r-t*i,l=-o*n+e*i;return[a*=s,l*=s]},t.insertSorted=function(e,t,n){for(var r=0,o=e.length;o>r;){var i=Math.floor((r+o)/2);n(t,e[i])>0?r=i+1:o=i}e.splice(r,0,t)},t.interpolateBetween2DPointsForY=function(e,t,n){var r,o=n-e.y,i=t.y-e.y;return i<0&&(o=-o,i=-i),r=o<=0?0:o>=i?1:i<1e-10?.5:o/i,e.x+r*(t.x-e.x)},t.isCAG=function(e){return"sides"in e&&"length"in e.sides},t.isCSG=function(e){return"polygons"in e&&"length"in e.polygons}},function(e,t,n){const r=n(2),o=n(1),i=n(7),s=n(11),{_CSGDEBUG:a,EPS:l,getTag:u,areaEPS:c}=n(0);let h=function(e,t,r){if(this.vertices=e,t||(t=h.defaultShared),this.shared=t,arguments.length>=3)this.plane=r;else{const t=n(6);this.plane=t.fromVector3Ds(e[0].pos,e[1].pos,e[2].pos)}if(a&&!this.checkIfConvex())throw new Error("Not convex!")};h.prototype={checkIfConvex:function(){return h.verticesConvex(this.vertices,this.plane.normal)},setColor:function(e){let t=h.Shared.fromColor.apply(this,arguments);return this.shared=t,this},getSignedVolume:function(){let e=0;for(let t=0;t<this.vertices.length-2;t++)e+=this.vertices[0].pos.dot(this.vertices[t+1].pos.cross(this.vertices[t+2].pos));return e/=6,e},getArea:function(){let e=0;for(let t=0;t<this.vertices.length-2;t++)e+=this.vertices[t+1].pos.minus(this.vertices[0].pos).cross(this.vertices[t+2].pos.minus(this.vertices[t+1].pos)).length();return e/=2,e},getTetraFeatures:function(e){let t=[];return e.forEach((function(e){"volume"===e?t.push(this.getSignedVolume()):"area"===e&&t.push(this.getArea())}),this),t},extrude:function(e){const{fromPolygons:t}=n(5);let o=[],s=this;s.plane.normal.dot(e)>0&&(s=s.flipped()),o.push(s);let a=s.translate(e),l=this.vertices.length,u=0,c=e.length();for(let e=0;e<l;e++){let t=[],n=e<l-1?e+1:0,f=u+s.vertices[e].pos.distanceTo(s.vertices[n].pos);t.push(i.fromPosAndUV(s.vertices[e].pos,new r(u,0))),t.push(i.fromPosAndUV(a.vertices[e].pos,new r(u,c))),t.push(i.fromPosAndUV(a.vertices[n].pos,new r(f,c))),t.push(i.fromPosAndUV(s.vertices[n].pos,new r(f,0)));let p=new h(t,this.shared);o.push(p),u=f}return a=a.flipped(),o.push(a),t(o)},translate:function(e){return this.transform(s.translation(e))},boundingSphere:function(){if(!this.cachedBoundingSphere){let e=this.boundingBox(),t=e[0].plus(e[1]).times(.5),n=e[1].minus(t).length();this.cachedBoundingSphere=[t,n]}return this.cachedBoundingSphere},boundingBox:function(){if(!this.cachedBoundingBox){let e,t,n=this.vertices,r=n.length;e=0===r?new o(0,0,0):n[0].pos,t=e;for(let o=1;o<r;o++){let r=n[o].pos;e=e.min(r),t=t.max(r)}this.cachedBoundingBox=[e,t]}return this.cachedBoundingBox},flipped:function(){let e=this.vertices.map((function(e){return e.flipped()}));e.reverse();let t=this.plane.flipped();return new h(e,this.shared,t)},transform:function(e){let t=this.vertices.map((function(t){return t.transform(e)})),n=this.plane.transform(e);return e.isMirroring()&&t.reverse(),new h(t,this.shared,n)},toString:function(){let e="Polygon plane: "+this.plane.toString()+"\n";return this.vertices.map((function(t){e+="  "+t.toString()+"\n"})),e},projectToOrthoNormalBasis:function(e){const t=n(10),{fromPointsNoCheck:r}=n(8);let o=r(this.vertices.map((function(t){return e.to2D(t.pos)}))),i=o.area();return Math.abs(i)<c?o=new t:i<0&&(o=o.flipped()),o},solidFromSlices:function(e){return n(73)(this,e)}},h.fromObject=function(e){const t=n(6);let r=e.vertices.map((function(e){return i.fromObject(e)})),o=h.Shared.fromObject(e.shared),s=t.fromObject(e.plane);return new h(r,o,s)},h.createFromPoints=function(e,t,n){let r,s=[];return e.map((function(e){let t=new o(e),n=new i(t);s.push(n)})),r=arguments.length<3?new h(s,t):new h(s,t,n),r},h.verticesConvex=function(e,t){let n=e.length;if(n>2){let r=e[n-2].pos,o=e[n-1].pos;for(let i=0;i<n;i++){let n=e[i].pos;if(!h.isConvexPoint(r,o,n,t))return!1;r=o,o=n}}return!0},h.isConvexPoint=function(e,t,n,r){return t.minus(e).cross(n.minus(t)).dot(r)>=0},h.isStrictlyConvexPoint=function(e,t,n,r){return t.minus(e).cross(n.minus(t)).dot(r)>=l},h.Shared=function(e){if(null!=e&&4!==e.length)throw new Error("Expecting 4 element array");this.color=e},h.Shared.fromObject=function(e){return new h.Shared(e.color)},h.Shared.fromColor=function(e){let t;if(1===arguments.length)t=arguments[0].slice();else{t=[];for(let e=0;e<arguments.length;e++)t.push(arguments[e])}if(3===t.length)t.push(1);else if(4!==t.length)throw new Error("setColor expects either an array with 3 or 4 elements, or 3 or 4 parameters.");return new h.Shared(t)},h.Shared.prototype={getTag:function(){let e=this.tag;return e||(e=u(),this.tag=e),e},getHash:function(){return this.color?this.color.join("/"):"null"}},h.defaultShared=new h.Shared(null),e.exports=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(7),i=n(6),s=n(30),a=n(4);t.fromPolygons=function(e){var t=new(n(15));return t.polygons=e,t.isCanonicalized=!1,t.isRetesselated=!1,t},t.fromSlices=function(e){return s.createFromPoints([[0,0,0],[1,0,0],[1,1,0],[0,1,0]]).solidFromSlices(e)},t.fromObject=function(e){var n=e.polygons.map((function(e){return a.fromObject(e)})),r=t.fromPolygons(n);return r.isCanonicalized=e.isCanonicalized,r.isRetesselated=e.isRetesselated,r},t.fromCompactBinary=function(e){if("CSG"!==e.class)throw new Error("Not a CSG");for(var n,s,l,u,c,h,f=[],p=e.planeData,d=p.length/4,g=0,m=0;m<d;m++)n=p[g++],s=p[g++],l=p[g++],u=p[g++],c=r.Create(n,s,l),h=new i(c,u),f.push(h);var v,y,w=[],x=e.vertexData,_=x.length/3;g=0;for(var b=0;b<_;b++)n=x[g++],s=x[g++],l=x[g++],v=r.Create(n,s,l),y=new o(v),w.push(y);var P,O,M,C,A=e.shared.map((function(e){return a.Shared.fromObject(e)})),T=[],S=e.numPolygons,E=e.numVerticesPerPolygon,j=e.polygonVertices,z=e.polygonPlaneIndexes,D=e.polygonSharedIndexes;g=0;for(var V=0;V<S;V++){P=E[V],O=[];for(var k=0;k<P;k++)O.push(w[j[g++]]);h=f[z[V]],M=A[D[V]],C=new a(O,M,h),T.push(C)}var I=t.fromPolygons(T);return I.isCanonicalized=!0,I.isRetesselated=!0,I}},function(e,t,n){const r=n(1),o=n(17),{EPS:i,getTag:s}=n(0),a=function(e,t){this.normal=e,this.w=t};a.fromObject=function(e){let t=new r(e.normal),n=parseFloat(e.w);return new a(t,n)},a.fromVector3Ds=function(e,t,n){let r=t.minus(e).cross(n.minus(e)).unit();return new a(r,r.dot(e))},a.anyPlaneFromVector3Ds=function(e,t,n){let r=t.minus(e),o=n.minus(e);r.length()<i&&(r=o.randomNonParallelVector()),o.length()<i&&(o=r.randomNonParallelVector());let s=r.cross(o);return s.length()<i&&(o=r.randomNonParallelVector(),s=r.cross(o)),s=s.unit(),new a(s,s.dot(e))},a.fromPoints=function(e,t,n){return e=new r(e),t=new r(t),n=new r(n),a.fromVector3Ds(e,t,n)},a.fromNormalAndPoint=function(e,t){e=new r(e),t=new r(t),e=e.unit();let n=t.dot(e);return new a(e,n)},a.prototype={flipped:function(){return new a(this.normal.negated(),-this.w)},getTag:function(){let e=this.tag;return e||(e=s(),this.tag=e),e},equals:function(e){return this.normal.equals(e.normal)&&this.w===e.w},transform:function(e){let t=e.isMirroring(),n=this.normal.randomNonParallelVector(),r=this.normal.cross(n),o=this.normal.cross(r),i=this.normal.times(this.w),s=i.plus(r),l=i.plus(o);i=i.multiply4x4(e),s=s.multiply4x4(e),l=l.multiply4x4(e);let u=a.fromVector3Ds(i,s,l);return t&&(u=u.flipped()),u},splitLineBetweenPoints:function(e,t){let n=t.minus(e),r=(this.w-this.normal.dot(e))/this.normal.dot(n);return isNaN(r)&&(r=0),r>1&&(r=1),r<0&&(r=0),e.plus(n.times(r))},intersectWithLine:function(e){return e.intersectWithPlane(this)},intersectWithPlane:function(e){return o.fromPlanes(this,e)},signedDistanceToPoint:function(e){return this.normal.dot(e)-this.w},toString:function(){return"[normal: "+this.normal.toString()+", w: "+this.w+"]"},mirrorPoint:function(e){let t=this.signedDistanceToPoint(e);return e.minus(this.normal.times(2*t))}},e.exports=a},function(e,t,n){const r=n(1),o=n(2),{getTag:i}=n(0),s=function(e){this.pos=e,this.uv=new o(0,0)};s.fromObject=function(e){var t=new r(e.pos);return new s(t)},s.fromPosAndUV=function(e,t){var n=new s(e);return n.uv=t,n},s.prototype={flipped:function(){return this},getTag:function(){var e=this.tag;return e||(e=i(),this.tag=e),e},interpolate:function(e,t){var n=this.pos.lerp(e.pos,t),r=this.uv.lerp(e.uv,t);return s.fromPosAndUV(n,r)},transform:function(e){var t=this.pos.multiply4x4(e);return s.fromPosAndUV(t,this.uv)},toString:function(){return this.pos.toString()}},e.exports=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),o=n(2),i=n(19),s=n(0),a=n(31),l=a.isSelfIntersecting,u=a.contains,c=n(22),h=c.union,f=c.difference;t.fromSides=function(e){var t=new(n(10));return t.sides=e,t},t.fromFakeCSG=function(e){var n=e.polygons.map((function(e){return r._fromFakePolygon(e)})).filter((function(e){return null!==e}));return t.fromSides(n)},t.fromPoints=function(e){if(!e)throw new Error("points parameter must be defined");if(!Array.isArray(e))throw new Error("points parameter must be an array");if(void 0!==e[0].x||"number"==typeof e[0][0])return t.fromPointsArray(e);if("object"==typeof e[0][0])return t.fromNestedPointsArray(e);throw new Error("Unsupported points list format")},t.fromPointsArray=function(e){if(e.length<3)throw new Error("CAG shape needs at least 3 points");var n=[],a=new i(new o(e[e.length-1]));e.map((function(e){var t=new i(new o(e));n.push(new r(a,t)),a=t}));var u=t.fromSides(n);if(l(u))throw new Error("Polygon is self intersecting!");var c=u.area();if(Math.abs(c)<s.areaEPS)throw new Error("Degenerate polygon!");return c<0&&(u=u.flipped()),u.canonicalized()},t.fromNestedPointsArray=function(e){if(1===e.length)return t.fromPoints(e[0]);var n=[];e.forEach((function(e){n.push(t.fromPointsArray(e))}));var r={};n.forEach((function(e,t){n.forEach((function(n,o){e!==n&&(r[t]||(r[t]={parents:[],isHole:!1}),r[o]||(r[o]={parents:[],isHole:!1}),u(n,e)&&(r[t].parents.push(o),r[t].isHole=!!(r[t].parents.length%2),r[o].isHole=!!(r[o].parents.length%2)))}))}));var o=null,i=function(e){(o=r[e]).isHole&&(delete r[e],o.parents.forEach((function(t){n[t]=f(n[t],n[e])})))};for(var s in r)i(s);var a=t.fromSides([]);for(var s in r)a=h(a,n[s]);return a},t.fromObject=function(e){var n=e.sides.map((function(e){return r.fromObject(e)})),o=t.fromSides(n);return o.isCanonicalized=e.isCanonicalized,o},t.fromPointsNoCheck=function(e){var n=[],s=new o(e[e.length-1]),a=new i(s);return e.map((function(e){var t=new o(e),s=new i(t),l=new r(a,s);n.push(l),a=s})),t.fromSides(n)},t.fromPath2=function(e){if(!e.isClosed())throw new Error("The path should be closed!");return t.fromPoints(e.getPoints())},t.fromCompactBinary=function(e){if("CAG"!==e.class)throw new Error("Not a CAG");for(var n=[],s=e.vertexData,a=s.length/2,l=0,u=0;u<a;u++){var c=s[l++],h=s[l++],f=new o(c,h),p=new i(f);n.push(p)}var d=[],g=e.sideVertexIndices.length/2;l=0;for(var m=0;m<g;m++){var v=e.sideVertexIndices[l++],y=e.sideVertexIndices[l++],w=new r(n[v],n[y]);d.push(w)}var x=t.fromSides(d);return x.isCanonicalized=!0,x}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(50),o=n(15);t.CSG=o;var i=n(10);t.CAG=i;var s=n(0);o._CSGDEBUG=s._CSGDEBUG,o.defaultResolution2D=s.defaultResolution2D,o.defaultResolution3D=s.defaultResolution3D,o.EPS=s.EPS,o.angleEPS=s.angleEPS,o.areaEPS=s.areaEPS,o.all=s.all,o.top=s.top,o.bottom=s.bottom,o.left=s.left,o.right=s.right,o.front=s.front,o.back=s.back,o.staticTag=s.staticTag,o.getTag=s.getTag,o.Vector2D=n(2),o.Vector3D=n(1),o.Vertex=n(7),i.Vertex=n(19),o.Plane=n(6),o.Polygon=n(4),o.Polygon2D=n(30),o.Line2D=n(21),o.Line3D=n(17),o.Path2D=n(20),o.OrthoNormalBasis=n(12),o.Matrix4x4=n(11),i.Side=n(18),o.Connector=n(13).Connector,o.ConnectorList=n(13).ConnectorList,o.Properties=n(26);var a=n(78),l=n(79);o.sphere=l.sphere,o.cube=l.cube,o.roundedCube=l.roundedCube,o.cylinder=l.cylinder,o.roundedCylinder=l.roundedCylinder,o.cylinderElliptic=l.cylinderElliptic,o.polyhedron=l.polyhedron,i.circle=a.circle,i.ellipse=a.ellipse,i.rectangle=a.rectangle,i.roundedRectangle=a.roundedRectangle;var u=n(5);o.fromCompactBinary=u.fromCompactBinary,o.fromObject=u.fromObject,o.fromSlices=u.fromSlices,o.fromPolygons=u.fromPolygons;var c=n(8);i.fromSides=c.fromSides,i.fromObject=c.fromObject,i.fromPoints=c.fromPoints,i.fromPointsNoCheck=c.fromPointsNoCheck,i.fromPath2=c.fromPath2,i.fromFakeCSG=c.fromFakeCSG,i.fromCompactBinary=c.fromCompactBinary;var h=n(14);r.addTransformationMethodsToPrototype(o.prototype),r.addTransformationMethodsToPrototype(o.Vector2D.prototype),r.addTransformationMethodsToPrototype(o.Vector3D.prototype),r.addTransformationMethodsToPrototype(o.Vertex.prototype),r.addTransformationMethodsToPrototype(o.Plane.prototype),r.addTransformationMethodsToPrototype(o.Polygon.prototype),r.addTransformationMethodsToPrototype(o.Line2D.prototype),r.addTransformationMethodsToPrototype(o.Line3D.prototype),r.addTransformationMethodsToPrototype(o.Path2D.prototype),r.addTransformationMethodsToPrototype(o.OrthoNormalBasis.prototype),r.addTransformationMethodsToPrototype(o.Connector.prototype),r.addTransformationMethodsToPrototype(i.prototype),r.addTransformationMethodsToPrototype(i.Side.prototype),r.addTransformationMethodsToPrototype(i.Vertex.prototype),o.parseOptionAs2DVector=h.parseOptionAs3DVector,o.parseOptionAs3DVector=h.parseOptionAs3DVector,o.parseOptionAs3DVectorList=h.parseOptionAs3DVectorList,o.parseOptionAsBool=h.parseOptionAsBool,o.parseOptionAsFloat=h.parseOptionAsFloat,o.parseOptionAsInt=h.parseOptionAsInt,o.Polygon2D.prototype=i.prototype;var f=n(3);t.isCAG=f.isCAG,t.isCSG=f.isCSG,t.parseOption=h.parseOption,t.parseOptionAsInt=h.parseOptionAsInt,t.parseOptionAsFloat=h.parseOptionAsFloat,t.parseOptionAsBool=h.parseOptionAsBool,t.parseOptionAs3DVector=h.parseOptionAs3DVector,t.parseOptionAs2DVector=h.parseOptionAs2DVector,t.parseOptionAs3DVectorList=h.parseOptionAs3DVectorList},function(e,t,n){const{Connector:r}=n(13),o=n(7),i=n(2),s=n(1),a=n(4),{fromPolygons:l}=n(5),{fromSides:u,fromFakeCSG:c}=n(8),h=n(32),f=n(35),{isCAGValid:p,isSelfIntersecting:d,hasPointInside:g}=n(31),{area:m,getBounds:v}=n(58),{overCutInsideCorners:y}=n(36),{extrudeInOrthonormalBasis:w,extrudeInPlane:x,extrude:_,rotateExtrude:b}=n(23),P=n(69),O=n(38),{expand:M,contract:C,expandedShellOfCAG:A}=n(39);let T=function(){this.sides=[],this.isCanonicalized=!1};T.prototype={union:function(e){let t;t=e instanceof Array?e:[e];let n=this._toCSGWall(-1,1);return n=n.union(t.map((function(e){return e._toCSGWall(-1,1).reTesselated()})),!1,!1),c(n).canonicalized()},subtract:function(e){let t;t=e instanceof Array?e:[e];let n=this._toCSGWall(-1,1);return t.map((function(e){n=n.subtractSub(e._toCSGWall(-1,1),!1,!1)})),n=n.reTesselated(),n=n.canonicalized(),n=c(n),n=n.canonicalized(),n},intersect:function(e){let t;t=e instanceof Array?e:[e];let n=this._toCSGWall(-1,1);return t.map((function(e){n=n.intersectSub(e._toCSGWall(-1,1),!1,!1)})),n=n.reTesselated(),n=n.canonicalized(),n=c(n),n=n.canonicalized(),n},transform:function(e){let t=e.isMirroring(),n=this.sides.map((function(t){return t.transform(e)})),r=u(n);return t&&(r=r.flipped()),r},flipped:function(){let e=this.sides.map((function(e){return e.flipped()}));return e.reverse(),u(e)},center:function(e){return O({axes:e},[this])},expandedShell:function(e,t){return A(this,e,t)},expand:function(e,t){return M(this,e,t)},contract:function(e,t){return C(this,e,t)},area:function(){return m(this)},getBounds:function(){return v(this)},isSelfIntersecting:function(e){return d(this,e)},extrudeInOrthonormalBasis:function(e,t,n){return w(this,e,t,n)},extrudeInPlane:function(e,t,n,r){return x(this,e,t,n,r)},extrude:function(e){return _(this,e)},rotateExtrude:function(e){return b(this,e)},check:function(){return p(this)},canonicalized:function(){return h(this)},reTesselated:function(){return f(this)},getOutlinePaths:function(){return P(this)},overCutInsideCorners:function(e){return y(this,e)},hasPointInside:function(e){return g(this,e)},toString:function(){let e="CAG ("+this.sides.length+" sides):\n";return this.sides.map((function(t){e+="  "+t.toString()+"\n"})),e},_toCSGWall:function(e,t){let n=this.sides.map((function(n){return n.toPolygon3D(e,t)}));return l(n)},_toVector3DPairs:function(e){let t=this.sides.map((function(e){let t=e.vertex0.pos,n=e.vertex1.pos;return[s.Create(t.x,t.y,0),s.Create(n.x,n.y,0)]}));return void 0!==e&&(t=t.map((function(t){return t.map((function(t){return t.transform(e)}))}))),t},_toPlanePolygons:function(e){e=Object.assign({},{flipped:!1},e);let{flipped:t}=e,n=[0,0,0],u=[0,0,1],c=[0,1,0],h=new r(n,u,c),f=e.translation||n,p=e.axisVector||u,d=e.normalVector||c,g=e.toConnector||new r(f,p,d),m=h.getTransformationTo(g,!1,0),v=this.getBounds();v[0]=v[0].minus(new i(1,1)),v[1]=v[1].plus(new i(1,1));let y=this._toCSGWall(-1,1),w=l([new a([new o(new s(v[0].x,v[0].y,0)),new o(new s(v[1].x,v[0].y,0)),new o(new s(v[1].x,v[1].y,0)),new o(new s(v[0].x,v[1].y,0))])]);t&&(w=w.invert()),w=w.intersectSub(y);let x=w.polygons.filter((function(e){return Math.abs(e.plane.normal.z)>.99}));return x.forEach((function(e){e.vertices.forEach((function(e){e.uv=new i(e.pos.x,e.pos.y)}))})),x.map((function(e){return e.transform(m)}))},_toWallPolygons:function(e,t=0){let n=new r([0,0,0],[0,0,1],[0,1,0]),s=e.toConnector1,l=e.toConnector2;if(!(s instanceof r&&l instanceof r))throw new Error("could not parse Connector arguments toConnector1 or toConnector2");if(e.cag&&e.cag.sides.length!==this.sides.length)throw new Error("target cag needs same sides count as start cag");let u=e.cag||this,c=n.getTransformationTo(s,s.axisvector.z<0,0),h=n.getTransformationTo(l,l.axisvector.z<0,0),f=this._toVector3DPairs(c),p=u._toVector3DPairs(h),d=s.axisvector.z<0,g=[],m=[],v=[f[0]],y=[p[0]],w=0;for(w=1;w<f.length;++w)f[w][1].equals(f[w-1][0])||f[w][0].equals(f[w-1][1])||(g.push(v),v=[],m.push(y),y=[]),v.push(f[w]),y.push(p[w]);g.push(v),m.push(y);let x=[];return g.forEach((function(e,n){let r=0,s=0;p=m[n],e.forEach((function(e,n){let l=r+e[0].distanceTo(e[1]),u=s+p[n][0].distanceTo(p[n][1]),c=e[0].distanceTo(p[n][0]),h=e[1].distanceTo(p[n][1]),f=new a([o.fromPosAndUV(p[n][1],new i(u,h*(1+t))),o.fromPosAndUV(p[n][0],new i(s,c*(1+t))),o.fromPosAndUV(e[0],new i(r,c*t))]),g=new a([o.fromPosAndUV(p[n][1],new i(u,h*(1+t))),o.fromPosAndUV(e[0],new i(r,c*t)),o.fromPosAndUV(e[1],new i(l,h*t))]);d&&(f.plane=f.plane.flipped(),g.plane=g.plane.flipped()),x.push(f),x.push(g),r=l,s=u}))})),x},toPoints:function(){let e=this.sides.map((function(e){return e.vertex0.pos}));return e.length>0&&e.push(e.shift()),e},toCompactBinary:function(){let e=this.canonicalized(),t=e.sides.length,n={},r=[],o=0,i=new Uint32Array(2*t),s=0;e.sides.map((function(e){[e.vertex0,e.vertex1].map((function(e){let t,a=e.getTag();a in n?t=n[a]:(t=o++,n[a]=t,r.push(e)),i[s++]=t}))}));let a=new Float64Array(2*o),l=0;return r.map((function(e){let t=e.pos;a[l++]=t._x,a[l++]=t._y})),{class:"CAG",sideVertexIndices:i,vertexData:a}}},e.exports=T},function(e,t,n){const r=n(1),o=n(2),i=n(12),s=n(6),a=function(e){arguments.length>=1?this.elements=e:this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};a.prototype={plus:function(e){for(var t=[],n=0;n<16;n++)t[n]=this.elements[n]+e.elements[n];return new a(t)},minus:function(e){for(var t=[],n=0;n<16;n++)t[n]=this.elements[n]-e.elements[n];return new a(t)},multiply:function(e){var t=this.elements[0],n=this.elements[1],r=this.elements[2],o=this.elements[3],i=this.elements[4],s=this.elements[5],l=this.elements[6],u=this.elements[7],c=this.elements[8],h=this.elements[9],f=this.elements[10],p=this.elements[11],d=this.elements[12],g=this.elements[13],m=this.elements[14],v=this.elements[15],y=e.elements[0],w=e.elements[1],x=e.elements[2],_=e.elements[3],b=e.elements[4],P=e.elements[5],O=e.elements[6],M=e.elements[7],C=e.elements[8],A=e.elements[9],T=e.elements[10],S=e.elements[11],E=e.elements[12],j=e.elements[13],z=e.elements[14],D=e.elements[15],V=[];return V[0]=t*y+n*b+r*C+o*E,V[1]=t*w+n*P+r*A+o*j,V[2]=t*x+n*O+r*T+o*z,V[3]=t*_+n*M+r*S+o*D,V[4]=i*y+s*b+l*C+u*E,V[5]=i*w+s*P+l*A+u*j,V[6]=i*x+s*O+l*T+u*z,V[7]=i*_+s*M+l*S+u*D,V[8]=c*y+h*b+f*C+p*E,V[9]=c*w+h*P+f*A+p*j,V[10]=c*x+h*O+f*T+p*z,V[11]=c*_+h*M+f*S+p*D,V[12]=d*y+g*b+m*C+v*E,V[13]=d*w+g*P+m*A+v*j,V[14]=d*x+g*O+m*T+v*z,V[15]=d*_+g*M+m*S+v*D,new a(V)},clone:function(){var e=this.elements.map((function(e){return e}));return new a(e)},rightMultiply1x3Vector:function(e){var t=e._x,n=e._y,o=e._z,i=t*this.elements[0]+n*this.elements[1]+o*this.elements[2]+1*this.elements[3],s=t*this.elements[4]+n*this.elements[5]+o*this.elements[6]+1*this.elements[7],a=t*this.elements[8]+n*this.elements[9]+o*this.elements[10]+1*this.elements[11],l=t*this.elements[12]+n*this.elements[13]+o*this.elements[14]+1*this.elements[15];if(1!==l){var u=1/l;i*=u,s*=u,a*=u}return new r(i,s,a)},leftMultiply1x3Vector:function(e){var t=e._x,n=e._y,o=e._z,i=t*this.elements[0]+n*this.elements[4]+o*this.elements[8]+1*this.elements[12],s=t*this.elements[1]+n*this.elements[5]+o*this.elements[9]+1*this.elements[13],a=t*this.elements[2]+n*this.elements[6]+o*this.elements[10]+1*this.elements[14],l=t*this.elements[3]+n*this.elements[7]+o*this.elements[11]+1*this.elements[15];if(1!==l){var u=1/l;i*=u,s*=u,a*=u}return new r(i,s,a)},rightMultiply1x2Vector:function(e){var t=e.x,n=e.y,r=t*this.elements[0]+n*this.elements[1]+0*this.elements[2]+1*this.elements[3],i=t*this.elements[4]+n*this.elements[5]+0*this.elements[6]+1*this.elements[7],s=(this.elements[8],this.elements[9],this.elements[10],this.elements[11],t*this.elements[12]+n*this.elements[13]+0*this.elements[14]+1*this.elements[15]);if(1!==s){var a=1/s;r*=a,i*=a,a}return new o(r,i)},leftMultiply1x2Vector:function(e){var t=e.x,n=e.y,r=t*this.elements[0]+n*this.elements[4]+0*this.elements[8]+1*this.elements[12],i=t*this.elements[1]+n*this.elements[5]+0*this.elements[9]+1*this.elements[13],s=(this.elements[2],this.elements[6],this.elements[10],this.elements[14],t*this.elements[3]+n*this.elements[7]+0*this.elements[11]+1*this.elements[15]);if(1!==s){var a=1/s;r*=a,i*=a,a}return new o(r,i)},isMirroring:function(){var e=new r(this.elements[0],this.elements[4],this.elements[8]),t=new r(this.elements[1],this.elements[5],this.elements[9]),n=new r(this.elements[2],this.elements[6],this.elements[10]);return e.cross(t).dot(n)<0}},a.unity=function(){return new a},a.rotationX=function(e){var t=e*Math.PI*(1/180),n=Math.cos(t),r=Math.sin(t);return new a([1,0,0,0,0,n,r,0,0,-r,n,0,0,0,0,1])},a.rotationY=function(e){var t=e*Math.PI*(1/180),n=Math.cos(t),r=Math.sin(t);return new a([n,0,-r,0,0,1,0,0,r,0,n,0,0,0,0,1])},a.rotationZ=function(e){var t=e*Math.PI*(1/180),n=Math.cos(t),r=Math.sin(t);return new a([n,r,0,0,-r,n,0,0,0,0,1,0,0,0,0,1])},a.rotation=function(e,t,n){e=new r(e),t=new r(t);var o=s.fromNormalAndPoint(t,e),l=new i(o),u=a.translation(e.negated());return u=(u=(u=(u=u.multiply(l.getProjectionMatrix())).multiply(a.rotationZ(n))).multiply(l.getInverseProjectionMatrix())).multiply(a.translation(e))},a.translation=function(e){var t=new r(e),n=[1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1];return new a(n)},a.mirroring=function(e){var t=e.normal.x,n=e.normal.y,r=e.normal.z,o=e.w;return new a([1-2*t*t,-2*n*t,-2*r*t,0,-2*t*n,1-2*n*n,-2*r*n,0,-2*t*r,-2*n*r,1-2*r*r,0,2*t*o,2*n*o,2*r*o,1])},a.scaling=function(e){var t=new r(e),n=[t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1];return new a(n)},e.exports=a},function(e,t,n){const r=n(2),o=n(1),i=n(21),s=n(17),a=n(6),l=function(e,t){t=arguments.length<2?e.normal.randomNonParallelVector():new o(t),this.v=e.normal.cross(t).unit(),this.u=this.v.cross(e.normal),this.plane=e,this.planeorigin=e.normal.times(e.w)};l.GetCartesian=function(e,t){let n,r,i=e+"/"+t;if("X/Y"===i)n=[0,0,1],r=[1,0,0];else if("Y/-X"===i)n=[0,0,1],r=[0,1,0];else if("-X/-Y"===i)n=[0,0,1],r=[-1,0,0];else if("-Y/X"===i)n=[0,0,1],r=[0,-1,0];else if("-X/Y"===i)n=[0,0,-1],r=[-1,0,0];else if("-Y/-X"===i)n=[0,0,-1],r=[0,-1,0];else if("X/-Y"===i)n=[0,0,-1],r=[1,0,0];else if("Y/X"===i)n=[0,0,-1],r=[0,1,0];else if("X/Z"===i)n=[0,-1,0],r=[1,0,0];else if("Z/-X"===i)n=[0,-1,0],r=[0,0,1];else if("-X/-Z"===i)n=[0,-1,0],r=[-1,0,0];else if("-Z/X"===i)n=[0,-1,0],r=[0,0,-1];else if("-X/Z"===i)n=[0,1,0],r=[-1,0,0];else if("-Z/-X"===i)n=[0,1,0],r=[0,0,-1];else if("X/-Z"===i)n=[0,1,0],r=[1,0,0];else if("Z/X"===i)n=[0,1,0],r=[0,0,1];else if("Y/Z"===i)n=[1,0,0],r=[0,1,0];else if("Z/-Y"===i)n=[1,0,0],r=[0,0,1];else if("-Y/-Z"===i)n=[1,0,0],r=[0,-1,0];else if("-Z/Y"===i)n=[1,0,0],r=[0,0,-1];else if("-Y/Z"===i)n=[-1,0,0],r=[0,-1,0];else if("-Z/-Y"===i)n=[-1,0,0],r=[0,0,-1];else if("Y/-Z"===i)n=[-1,0,0],r=[0,1,0];else{if("Z/Y"!==i)throw new Error("OrthoNormalBasis.GetCartesian: invalid combination of axis identifiers. Should pass two string arguments from [X,Y,Z,-X,-Y,-Z], being two different axes.");n=[-1,0,0],r=[0,0,1]}return new l(new a(new o(n),0),new o(r))},l.Z0Plane=function(){let e=new a(new o([0,0,1]),0);return new l(e,new o([1,0,0]))},l.prototype={getProjectionMatrix:function(){return new(n(11))([this.u.x,this.v.x,this.plane.normal.x,0,this.u.y,this.v.y,this.plane.normal.y,0,this.u.z,this.v.z,this.plane.normal.z,0,0,0,-this.plane.w,1])},getInverseProjectionMatrix:function(){const e=n(11);let t=this.plane.normal.times(this.plane.w);return new e([this.u.x,this.u.y,this.u.z,0,this.v.x,this.v.y,this.v.z,0,this.plane.normal.x,this.plane.normal.y,this.plane.normal.z,0,t.x,t.y,t.z,1])},to2D:function(e){return new r(e.dot(this.u),e.dot(this.v))},to3D:function(e){return this.planeorigin.plus(this.u.times(e.x)).plus(this.v.times(e.y))},line3Dto2D:function(e){let t=e.point,n=e.direction.plus(t),r=this.to2D(t),o=this.to2D(n);return i.fromPoints(r,o)},line2Dto3D:function(e){let t=e.origin(),n=e.direction().plus(t),r=this.to3D(t),o=this.to3D(n);return s.fromPoints(r,o)},transform:function(e){let t=this.plane.transform(e),n=this.u.transform(e),r=new o(0,0,0).transform(e),i=n.minus(r);return new l(t,i)}},e.exports=l},function(e,t,n){const r=n(1),o=n(17),i=n(11),s=n(12),a=n(6),l=function(e,t,n){this.point=new r(e),this.axisvector=new r(t).unit(),this.normalvector=new r(n).unit()};l.prototype={normalized:function(){let e=this.axisvector.unit(),t=this.normalvector.cross(e).unit(),n=e.cross(t);return new l(this.point,e,n)},transform:function(e){let t=this.point.multiply4x4(e),n=this.point.plus(this.axisvector).multiply4x4(e).minus(t),r=this.point.plus(this.normalvector).multiply4x4(e).minus(t);return new l(t,n,r)},getTransformationTo:function(e,t,n){t=!!t,n=n?Number(n):0;let o=this.normalized();e=e.normalized();let l=i.translation(this.point.negated()),u=a.anyPlaneFromVector3Ds(new r(0,0,0),o.axisvector,e.axisvector),c=new s(u),h=c.to2D(o.axisvector).angle(),f=c.to2D(e.axisvector).angle(),p=180*(f-h)/Math.PI;t&&(p+=180),l=l.multiply(c.getProjectionMatrix()),l=l.multiply(i.rotationZ(p)),l=l.multiply(c.getInverseProjectionMatrix());let d=o.transform(l),g=a.fromNormalAndPoint(e.axisvector,new r(0,0,0)),m=new s(g);return h=m.to2D(d.normalvector).angle(),f=m.to2D(e.normalvector).angle(),p=180*(f-h)/Math.PI,p+=n,l=l.multiply(m.getProjectionMatrix()),l=l.multiply(i.rotationZ(p)),l=l.multiply(m.getInverseProjectionMatrix()),l=l.multiply(i.translation(e.point)),l},axisLine:function(){return new o(this.point,this.axisvector)},extend:function(e){let t=this.point.plus(this.axisvector.unit().times(e));return new l(t,this.axisvector,this.normalvector)}};const u=function(e){this.connectors_=e?e.slice():[]};u.defaultNormal=[0,0,1],u.fromPath2D=function(e,t,n){if(3===arguments.length)return u._fromPath2DTangents(e,t,n);if(2===arguments.length)return u._fromPath2DExplicit(e,t);throw new Error("call with path2D and either 2 direction vectors, or a function returning direction vectors")},u._fromPath2DTangents=function(e,t,n){let r,o=e.points.length,i=new u([new l(e.points[0],t,u.defaultNormal)]);return e.points.slice(1,o-1).forEach((function(t,n){r=e.points[n+2].minus(e.points[n]).toVector3D(0),i.appendConnector(new l(t.toVector3D(0),r,u.defaultNormal))}),this),i.appendConnector(new l(e.points[o-1],n,u.defaultNormal)),i.closed=e.closed,i},u._fromPath2DExplicit=function(e,t){let n=new u(e.points.map((function(e,n){return new l(e.toVector3D(0),r.Create(1,0,0).rotateZ(function(e,t,n){return"function"==typeof e&&(e=e(t,n)),e}(t,e,n)),u.defaultNormal)}),this));return n.closed=e.closed,n},u.prototype={setClosed:function(e){this.closed=!!e},appendConnector:function(e){this.connectors_.push(e)},followWith:function(e){const t=n(15);function r(e,t){return"function"==typeof e&&(e=e(t.point,t.axisvector,t.normalvector)),e}this.verify();let o,i=[],s=this.connectors_[this.connectors_.length-1],a=r(e,s);return this.connectors_.forEach((function(t,n){o=r(e,t),n||this.closed?i.push.apply(i,a._toWallPolygons({toConnector1:s,toConnector2:t,cag:o})):i.push.apply(i,o._toPlanePolygons({toConnector:t,flipped:!0})),n!==this.connectors_.length-1||this.closed||i.push.apply(i,o._toPlanePolygons({toConnector:t})),a=o,s=t}),this),t.fromPolygons(i).reTesselated().canonicalized()},verify:function(){let e,t;for(let n=0;n<this.connectors_.length-1;n++){if(e=this.connectors_[n],t=this.connectors_[n+1],t.point.minus(e.point).dot(e.axisvector)<=0)throw new Error("Invalid ConnectorList. Each connectors position needs to be within a <90deg range of previous connectors axisvector");if(e.axisvector.dot(t.axisvector)<=0)throw new Error("invalid ConnectorList. No neighboring connectors axisvectors may span a >=90deg angle")}}},e.exports={Connector:l,ConnectorList:u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(2);t.parseOption=function(e,t,n){var r=n;return e&&t in e&&(r=e[t]),r},t.parseOptionAs3DVector=function(e,n,o){var i=t.parseOption(e,n,o);return i=new r(i)},t.parseOptionAs3DVectorList=function(e,n,o){return t.parseOption(e,n,o).map((function(e){return new r(e)}))},t.parseOptionAs2DVector=function(e,n,r){var i=t.parseOption(e,n,r);return i=new o(i)},t.parseOptionAsFloat=function(e,n,r){var o=t.parseOption(e,n,r);if("string"==typeof o&&(o=Number(o)),isNaN(o)||"number"!=typeof o)throw new Error("Parameter "+n+" should be a number");return o},t.parseOptionAsInt=function(e,n,r){var o=t.parseOption(e,n,r);if(o=Number(Math.floor(o)),isNaN(o))throw new Error("Parameter "+n+" should be a number");return o},t.parseOptionAsBool=function(e,n,r){var o=t.parseOption(e,n,r);return"string"==typeof o&&("true"===o?o=!0:("false"===o||"0"===o)&&(o=!1)),o=!!o}},function(e,t,n){const r=n(51),o=n(4),i=n(6),s=n(12),a=(n(10),n(26)),{fromPolygons:l}=n(5),u=n(74),c=n(32),h=n(35),{bounds:f}=n(75),{projectToOrthoNormalBasis:p}=n(76),{lieFlat:d,getTransformationToFlatLying:g,getTransformationAndInverseTransformationToFlatLying:m}=n(36),{sectionCut:v,cutByPlane:y}=n(77),w=n(38),{expand:x,contract:_,expandedShellOfCCSG:b}=n(39);let P=function(){this.polygons=[],this.properties=new a,this.isCanonicalized=!0,this.isRetesselated=!0};P.prototype={union:function(e){let t,n;for(e instanceof Array?(t=e.slice(0),t.push(this)):t=[this,e],n=1;n<t.length;n+=2)t.push(t[n-1].unionSub(t[n]));return t[n-1].reTesselated().canonicalized()},unionSub:function(e,t,n){if(this.mayOverlap(e)){let o=new r(this.polygons),i=new r(e.polygons);o.clipTo(i,!1),i.clipTo(o),i.invert(),i.clipTo(o),i.invert();let s=o.allPolygons().concat(i.allPolygons()),a=l(s);return a.properties=this.properties._merge(e.properties),t&&(a=a.reTesselated()),n&&(a=a.canonicalized()),a}return this.unionForNonIntersecting(e)},unionForNonIntersecting:function(e){let t=this.polygons.concat(e.polygons),n=l(t);return n.properties=this.properties._merge(e.properties),n.isCanonicalized=this.isCanonicalized&&e.isCanonicalized,n.isRetesselated=this.isRetesselated&&e.isRetesselated,n},subtract:function(e){let t;t=e instanceof Array?e:[e];let n=this;for(let e=0;e<t.length;e++){let r=e===t.length-1;n=n.subtractSub(t[e],r,r)}return n},subtractSub:function(e,t,n){let o=new r(this.polygons),i=new r(e.polygons);o.invert(),o.clipTo(i),i.clipTo(o,!0),o.addPolygons(i.allPolygons()),o.invert();let s=l(o.allPolygons());return s.properties=this.properties._merge(e.properties),t&&(s=s.reTesselated()),n&&(s=s.canonicalized()),s},intersect:function(e){let t;t=e instanceof Array?e:[e];let n=this;for(let e=0;e<t.length;e++){let r=e===t.length-1;n=n.intersectSub(t[e],r,r)}return n},intersectSub:function(e,t,n){let o=new r(this.polygons),i=new r(e.polygons);o.invert(),i.clipTo(o),i.invert(),o.clipTo(i),i.clipTo(o),o.addPolygons(i.allPolygons()),o.invert();let s=l(o.allPolygons());return s.properties=this.properties._merge(e.properties),t&&(s=s.reTesselated()),n&&(s=s.canonicalized()),s},invert:function(){let e=this.polygons.map((function(e){return e.flipped()}));return l(e)},transform1:function(e){let t=this.polygons.map((function(t){return t.transform(e)})),n=l(t);return n.properties=this.properties._transform(e),n.isRetesselated=this.isRetesselated,n},transform:function(e){let t=e.isMirroring(),n={},r={},i=this.polygons.map((function(i){let s,a=i.plane,l=a.getTag();l in r?s=r[l]:(s=a.transform(e),r[l]=s);let u=i.vertices.map((function(t){let r,o=t.getTag();return o in n?r=n[o]:(r=t.transform(e),n[o]=r),r}));return t&&u.reverse(),new o(u,i.shared,s)})),s=l(i);return s.properties=this.properties._transform(e),s.isRetesselated=this.isRetesselated,s.isCanonicalized=this.isCanonicalized,s},center:function(e){return w({axes:e},[this])},expand:function(e,t){return x(this,e,t)},contract:function(e,t){return _(this,e,t)},expandedShell:function(e,t,n){return b(this,e,t,n)},stretchAtPlane:function(e,t,n){let r=i.fromNormalAndPoint(e,t),o=new s(r),a=this.sectionCut(o).extrudeInOrthonormalBasis(o,n),l=this.cutByPlane(r),u=this.cutByPlane(r.flipped());return l.union([a,u.translate(r.normal.times(n))])},canonicalized:function(){return c(this)},reTesselated:function(){return h(this)},fixTJunctions:function(){return u(l,this)},getBounds:function(){return f(this)},mayOverlap:function(e){if(0===this.polygons.length||0===e.polygons.length)return!1;{let t=f(this),n=f(e);return!(t[1].x<n[0].x)&&(!(t[0].x>n[1].x)&&(!(t[1].y<n[0].y)&&(!(t[0].y>n[1].y)&&(!(t[1].z<n[0].z)&&!(t[0].z>n[1].z)))))}},cutByPlane:function(e){return y(this,e)},connectTo:function(e,t,n,r){let o=e.getTransformationTo(t,n,r);return this.transform(o)},setShared:function(e){let t=this.polygons.map((function(t){return new o(t.vertices,e,t.plane)})),n=l(t);return n.properties=this.properties,n.isRetesselated=this.isRetesselated,n.isCanonicalized=this.isCanonicalized,n},setColor:function(e){let t=o.Shared.fromColor.apply(this,arguments);return this.setShared(t)},getTransformationAndInverseTransformationToFlatLying:function(){return m(this)},getTransformationToFlatLying:function(){return g(this)},lieFlat:function(){return d(this)},projectToOrthoNormalBasis:function(e){return p(this,e)},sectionCut:function(e){return v(this,e)},getFeatures:function(e){e instanceof Array||(e=[e]);let t=this.toTriangles().map((function(t){return t.getTetraFeatures(e)})).reduce((function(e,t){return t.map((function(t,n){return t+(0===e?0:e[n])}))}),0);return 1===t.length?t[0]:t},toPolygons:function(){return this.polygons},toString:function(){let e="CSG solid:\n";return this.polygons.map((function(t){e+=t.toString()})),e},toCompactBinary:function(){let e=this.canonicalized(),t=e.polygons.length,n=0,r=0,o={},i=[],s=0,a={},l=[],u=[],c={},h=0;e.polygons.map((function(e){e.vertices.map((function(e){++n;let t=e.getTag();t in o||(o[t]=r++,i.push(e))}));let t=e.plane.getTag();t in a||(a[t]=s++,l.push(e.plane));let f=e.shared.getTag();f in c||(c[f]=h++,u.push(e.shared))}));let f=new Uint32Array(t),p=new Uint32Array(t),d=new Uint32Array(n),g=new Uint32Array(t),m=new Float64Array(3*r),v=new Float64Array(4*s),y=0;for(let n=0;n<t;++n){let t=e.polygons[n];f[n]=t.vertices.length,t.vertices.map((function(e){let t=e.getTag(),n=o[t];d[y++]=n}));let r=t.plane.getTag(),i=a[r];g[n]=i;let s=t.shared.getTag(),l=c[s];p[n]=l}let w=0;i.map((function(e){const t=e.pos;m[w++]=t._x,m[w++]=t._y,m[w++]=t._z}));let x=0;return l.map((function(e){const t=e.normal;v[x++]=t._x,v[x++]=t._y,v[x++]=t._z,v[x++]=e.w})),{class:"CSG",numPolygons:t,numVerticesPerPolygon:f,polygonPlaneIndexes:g,polygonSharedIndexes:p,polygonVertices:d,vertexData:m,planeData:v,shared:u}},toTriangles:function(){let e=[];return this.polygons.forEach((function(t){let n=t.vertices[0];for(let r=t.vertices.length-3;r>=0;r--)e.push(new o([n,t.vertices[r+1],t.vertices[r+2]],t.shared,t.plane))})),e}},e.exports=P},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(84);t.translate=r.translate;var o=n(85);t.scale=o.scale;var i=n(86);t.rotate=i.rotate;var s=n(87);t.transform=s.transform;var a=n(88);t.center=a.center;var l=n(89);t.mirror=l.mirror;var u=n(90);t.expand=u.expand;var c=n(91);t.contract=c.contract;var h=n(92);t.minkowski=h.minkowski;var f=n(40);t.hull=f.hull;var p=n(95);t.chain_hull=p.chain_hull},function(e,t,n){const r=n(1),{EPS:o}=n(0),{solve2Linear:i}=n(3),s=function(e,t){e=new r(e),t=new r(t),this.point=e,this.direction=t.unit()};s.fromPoints=function(e,t){e=new r(e);let n=(t=new r(t)).minus(e);return new s(e,n)},s.fromPlanes=function(e,t){let n=e.normal.cross(t.normal),a=n.length();if(a<o)throw new Error("Parallel planes");n=n.times(1/a);let l,u=Math.abs(n.x),c=Math.abs(n.y),h=Math.abs(n.z);if(u>=c&&u>=h){let n=i(e.normal.y,e.normal.z,t.normal.y,t.normal.z,e.w,t.w);l=new r(0,n[0],n[1])}else if(c>=u&&c>=h){let n=i(e.normal.x,e.normal.z,t.normal.x,t.normal.z,e.w,t.w);l=new r(n[0],0,n[1])}else{let n=i(e.normal.x,e.normal.y,t.normal.x,t.normal.y,e.w,t.w);l=new r(n[0],n[1],0)}return new s(l,n)},s.prototype={intersectWithPlane:function(e){let t=(e.w-e.normal.dot(this.point))/e.normal.dot(this.direction);return this.point.plus(this.direction.times(t))},clone:function(e){return new s(this.point.clone(),this.direction.clone())},reverse:function(){return new s(this.point.clone(),this.direction.negated())},transform:function(e){let t=this.point.multiply4x4(e),n=this.point.plus(this.direction).multiply4x4(e).minus(t);return new s(t,n)},closestPointOnLine:function(e){let t=(e=new r(e)).minus(this.point).dot(this.direction)/this.direction.dot(this.direction);return this.point.plus(this.direction.times(t))},distanceToPoint:function(e){e=new r(e);let t=this.closestPointOnLine(e);return e.minus(t).length()},equals:function(e){if(!this.direction.equals(e.direction))return!1;return!(this.distanceToPoint(e.point)>o)}},e.exports=s},function(e,t,n){const r=n(2),o=n(19),i=n(7),s=n(4),{getTag:a}=n(0),l=function(e,t){if(!(e instanceof o))throw new Error("Assertion failed");if(!(t instanceof o))throw new Error("Assertion failed");this.vertex0=e,this.vertex1=t};l.fromObject=function(e){var t=o.fromObject(e.vertex0),n=o.fromObject(e.vertex1);return new l(t,n)},l._fromFakePolygon=function(e){if(e.vertices.length<4)return null;var t=[],n=e.vertices.filter((function(e,n){return e.pos.z>0&&(t.push(n),!0)})).map((function(e){return new r(e.pos.x,e.pos.y)}));if(2!==n.length)throw new Error("Assertion failed: _fromFakePolygon: not enough points found");var i=t[1]-t[0];if(1!==i&&3!==i)throw new Error("Assertion failed: _fromFakePolygon: unknown index ordering");return 1===i&&n.reverse(),new l(new o(n[0]),new o(n[1]))},l.prototype={toString:function(){return this.vertex0+" -> "+this.vertex1},toPolygon3D:function(e,t){const n=[new i(this.vertex0.pos.toVector3D(e)),new i(this.vertex1.pos.toVector3D(e)),new i(this.vertex1.pos.toVector3D(t)),new i(this.vertex0.pos.toVector3D(t))];return new s(n)},transform:function(e){var t=this.vertex0.pos.transform(e),n=this.vertex1.pos.transform(e);return new l(new o(t),new o(n))},flipped:function(){return new l(this.vertex1,this.vertex0)},direction:function(){return this.vertex1.pos.minus(this.vertex0.pos)},getTag:function(){var e=this.tag;return e||(e=a(),this.tag=e),e},lengthSquared:function(){let e=this.vertex1.pos.x-this.vertex0.pos.x,t=this.vertex1.pos.y-this.vertex0.pos.y;return e*e+t*t},length:function(){return Math.sqrt(this.lengthSquared())}},e.exports=l},function(e,t,n){const r=n(2),{getTag:o}=n(0),i=function(e){this.pos=e};i.fromObject=function(e){return new i(new r(e.pos._x,e.pos._y))},i.prototype={toString:function(){return"("+this.pos.x.toFixed(5)+","+this.pos.y.toFixed(5)+")"},getTag:function(){var e=this.tag;return e||(e=o(),this.tag=e),e}},e.exports=i},function(e,t,n){const r=n(2),{EPS:o,angleEPS:i}=n(0),{parseOptionAs2DVector:s,parseOptionAsFloat:a,parseOptionAsInt:l,parseOptionAsBool:u}=n(14),{defaultResolution2D:c}=n(0),h=n(19),f=n(18),p=function(e,t){e=e||[];let n=null;(t=!!t)&&e.length>0&&(n=new r(e[e.length-1]));let i=[];e.map((function(e){e=new r(e);let t=!1;if(null!==n){t=e.distanceTo(n)<o}t||i.push(e),n=e})),this.points=i,this.closed=t};p.arc=function(e){let t=s(e,"center",0),n=a(e,"radius",1),o=a(e,"startangle",0),h=a(e,"endangle",360),f=l(e,"resolution",c),d=u(e,"maketangent",!1);for(;h-o>=720;)h-=360;for(;h-o<=-720;)h+=360;let g,m=[],v=Math.abs(h-o);if(v<i)g=r.fromAngle(o/180*Math.PI).times(n),m.push(g.plus(t));else{let e=Math.floor(f*v/360)+1,i=.5*e/v;i>.25&&(i=.25);let s=d?e+2:e;for(let a=0;a<=s;a++){let s=a;d&&(s=(a-1)*(e-2*i)/e+i,s<0&&(s=0),s>e&&(s=e));let l=o+s*(h-o)/e;g=r.fromAngle(l/180*Math.PI).times(n),m.push(g.plus(t))}}return new p(m,!1)},p.prototype={concat:function(e){if(this.closed||e.closed)throw new Error("Paths must not be closed");let t=this.points.concat(e.points);return new p(t)},getPoints:function(){return this.points},appendPoint:function(e){if(this.closed)throw new Error("Path must not be closed");e=new r(e);let t=this.points.concat([e]);return new p(t)},appendPoints:function(e){if(this.closed)throw new Error("Path must not be closed");let t=this.points;return e.forEach((function(e){t.push(new r(e))})),new p(t)},close:function(){return new p(this.points,!0)},isClosed:function(){return this.closed},getTurn:function(){const e=this.points;let t=0,n=e.length-1;for(let r=0;r<e.length;n=r++)t+=e[n].x*e[r].y-e[n].y*e[r].x;return t>0?"clockwise":t<0?"counter-clockwise":"straight"},rectangularExtrude:function(e,t,n){return this.expandToCAG(e/2,n).extrude({offset:[0,0,t]})},expandToCAG:function(e,t){const r=n(10);let o,i=[],s=this.points.length,a=0;this.closed&&s>2&&(a=-1);for(let e=a;e<s;e++){let t=e;t<0&&(t=s-1);let n=this.points[t],r=new h(n);if(e>a){let e=new f(o,r);i.push(e)}o=r}return r.fromSides(i).expandedShell(e,t)},innerToCAG:function(){const e=n(10);if(!this.closed)throw new Error("The path should be closed!");return e.fromPoints(this.points)},transform:function(e){let t=this.points.map((function(t){return t.multiply4x4(e)}));return new p(t,this.closed)},appendBezier:function(e,t){if(arguments.length<2&&(t={}),this.closed)throw new Error("Path must not be closed");if(!(e instanceof Array))throw new Error("appendBezier: should pass an array of control points");if(e.length<1)throw new Error("appendBezier: need at least 1 control point");if(this.points.length<1)throw new Error("appendBezier: path must already contain a point (the endpoint of the path is used as the starting point for the bezier curve)");let n=l(t,"resolution",c);n<4&&(n=4);let o=[],i=[];i.push(this.points[this.points.length-1]);for(let t=0;t<e.length;++t){let n=e[t];if(null===n){if(0!==t)throw new Error("appendBezier: null can only be passed as the first control point");if(e.length<2)throw new Error("appendBezier: null can only be passed if there is at least one more control point");let r;if("lastBezierControlPoint"in this)r=this.lastBezierControlPoint;else{if(this.points.length<2)throw new Error("appendBezier: null is passed as a control point but this requires a previous bezier curve or at least two points in the existing path");r=this.points[this.points.length-2]}n=this.points[this.points.length-1].times(2).minus(r)}else n=new r(n);i.push(n)}let s=i.length-1,a=1;for(let e=0;e<=s;++e)e>0&&(a*=e),o.push(a);let u=[];for(let e=0;e<=s;++e){let t=o[s]/(o[e]*o[s-e]);u.push(t)}let h=function(e){let t=1,n=Math.pow(1-e,s),o=1!==e?1/(1-e):1,a=new r(0,0);for(let r=0;r<=s;++r){r===s&&(n=1);let l=u[r]*t*n;a=a.plus(i[r].times(l)),t*=e,n*=o}return a},f=[],d=[],g=s+1;for(let e=0;e<g;++e){let t=e/(g-1),n=h(t);f.push(n),d.push(t)}let m=1,v=2*Math.PI/n,y=Math.sin(v);for(;m<f.length-1;){let e=f[m].minus(f[m-1]).unit(),t=f[m+1].minus(f[m]).unit(),n=e.cross(t);if(Math.abs(n)>y){let e=d[m-1],t=d[m+1],n=e+1*(t-e)/3,r=e+2*(t-e)/3,o=h(n),i=h(r);f.splice(m,1,o,i),d.splice(m,1,n,r),m--,m<1&&(m=1)}else++m}f=this.points.concat(f.slice(1));let w=new p(f);return w.lastBezierControlPoint=i[i.length-2],w},appendArc:function(e,t){let n=1e5;if(arguments.length<2&&(t={}),this.closed)throw new Error("Path must not be closed");if(this.points.length<1)throw new Error("appendArc: path must already contain a point (the endpoint of the path is used as the starting point for the arc)");let o,i,s=l(t,"resolution",c);if(s<4&&(s=4),"xradius"in t||"yradius"in t){if("radius"in t)throw new Error("Should either give an xradius and yradius parameter, or a radius parameter");o=a(t,"xradius",0),i=a(t,"yradius",0)}else o=a(t,"radius",0),i=o;let h=a(t,"xaxisrotation",0),f=u(t,"clockwise",!1),d=u(t,"large",!1),g=this.points[this.points.length-1];e=new r(e),o=Math.round(o*n)/n,i=Math.round(i*n)/n,e=new r(Math.round(e.x*n)/n,Math.round(e.y*n)/n);let m=!f,v=[];if(0===o||0===i)v.push(e);else{o=Math.abs(o),i=Math.abs(i);let t=h*Math.PI/180,a=Math.cos(t),l=Math.sin(t),u=g.minus(e).times(.5),c=Math.round((a*u.x+l*u.y)*n)/n,f=Math.round((-l*u.x+a*u.y)*n)/n,p=new r(c,f),y=p.x*p.x/(o*o)+p.y*p.y/(i*i);if(y>1){let e=Math.sqrt(y);o*=e,i*=e,o=Math.round(o*n)/n,i=Math.round(i*n)/n}let w=Math.sqrt((o*o*i*i-o*o*p.y*p.y-i*i*p.x*p.x)/(o*o*p.y*p.y+i*i*p.x*p.x));m===d&&(w=-w);let x=new r(o*p.y/i,-i*p.x/o).times(w),_=new r(a*x.x-l*x.y,l*x.x+a*x.y).plus(g.plus(e).times(.5)),b=new r((p.x-x.x)/o,(p.y-x.y)/i),P=new r((-p.x-x.x)/o,(-p.y-x.y)/i),O=b.angleRadians(),M=P.angleRadians()-O;M%=2*Math.PI,!m&&M>0?M-=2*Math.PI:m&&M<0&&(M+=2*Math.PI);let C=Math.ceil(Math.abs(M)/(2*Math.PI)*s)+1;C<1&&(C=1);for(let e=1;e<=C;e++){let t=O+e/C*M,n=Math.cos(t),s=Math.sin(t),u=new r(a*o*n-l*i*s,l*o*n+a*i*s).plus(_);v.push(u)}}v=this.points.concat(v);let y=new p(v);return y}},e.exports=p},function(e,t,n){const r=n(2),{solve2Linear:o}=n(3),i=function(e,t){e=new r(e),t=parseFloat(t);let n=e.length();t*=n,e=e.times(1/n),this.normal=e,this.w=t};i.fromPoints=function(e,t){e=new r(e);let n=(t=new r(t)).minus(e).normal().negated().unit(),o=e.dot(n);return new i(n,o)},i.prototype={reverse:function(){return new i(this.normal.negated(),-this.w)},equals:function(e){return e.normal.equals(this.normal)&&e.w===this.w},origin:function(){return this.normal.times(this.w)},direction:function(){return this.normal.normal()},xAtY:function(e){return(this.w-this.normal._y*e)/this.normal.x},absDistanceToPoint:function(e){let t=(e=new r(e)).dot(this.normal);return Math.abs(t-this.w)},intersectWithLine:function(e){let t=o(this.normal.x,this.normal.y,e.normal.x,e.normal.y,this.w,e.w);return t=new r(t),t},transform:function(e){let t=new r(0,0),n=this.normal.times(this.w),o=t.multiply4x4(e),s=this.normal.multiply4x4(e).minus(o),a=n.multiply4x4(e),l=s.dot(a);return new i(s,l)}},e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(53);t.union=r.union;var o=n(54);t.difference=o.difference;var i=n(55);t.intersection=i.intersection},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37);t.extrudeInOrthonormalBasis=r.extrudeInOrthonormalBasis;var o=n(59);t.extrudeInPlane=o.extrudeInPlane;var i=n(60);t.extrude=i.extrude;var s=n(61);t.rotateExtrude=s.rotateExtrude;var a=n(62);t.linear_extrude=a.linear_extrude;var l=n(63);t.rotate_extrude=l.rotate_extrude;var u=n(68);t.rectangular_extrude=u.rectangular_extrude},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(7),i=n(4),s=n(3);t.expandedShellOfCCSG=function(e,t,a,l){var u,c=n(15),h=n(5).fromPolygons,f=e.reTesselated();u=l?f:new c,f.polygons.map((function(e){var n=e.plane.normal.unit().times(2*t),r=e.translate(n.times(-.5)).extrude(n);u=u.unionSub(r,!1,!1)}));var p={};for(var d in f.polygons.map((function(e){for(var t=e.vertices.length,n=e.vertices[t-1],r=n.getTag(),o=0;o<t;o++){var i=e.vertices[o],s=i.getTag(),a=void 0,l=void 0;(a=s<r?s+"-"+r:r+"-"+s)in p?l=p[a]:(l={v1:n,v2:i,planenormals:[]},p[a]=l),l.planenormals.push(e.plane.normal),r=s,n=i}})),p){for(var g=p[d],m=g.v1.pos,v=g.v2.pos,y=v.minus(m).unit(),w=g.planenormals[0].unit(),x=w.cross(y),_=[],b=0;b<a;b++)_.push(b*Math.PI*2/a);b=0;for(var P=g.planenormals.length;b<P;b++){var O=g.planenormals[b],M=x.dot(O),C=w.dot(O);(D=Math.atan2(M,C))<0&&(D+=2*Math.PI),_.push(D),(D=Math.atan2(-M,-C))<0&&(D+=2*Math.PI),_.push(D)}var A=(_=_.sort(s.fnNumberSort)).length,T=void 0,S=void 0,E=[],j=[],z=[];for(b=-1;b<A;b++){var D=_[b<0?b+A:b],V=(M=Math.sin(D),C=Math.cos(D),w.times(C*t).plus(x.times(M*t))),k=m.plus(V),I=v.plus(V),F=!1;if(b>=0&&k.distanceTo(T)<r.EPS&&(F=!0),!F){if(b>=0){E.push(new o(k)),j.push(new o(I));var B=[new o(S),new o(I),new o(k),new o(T)],G=new i(B);z.push(G)}T=k,S=I}}j.reverse(),z.push(new i(E)),z.push(new i(j));var N=h(z);u=u.unionSub(N,!1,!1)}var R={};for(var q in f.polygons.map((function(e){e.vertices.map((function(t){var n,r=t.getTag();r in R?n=R[r]:(n={pos:t.pos,normals:[]},R[r]=n),n.normals.push(e.plane.normal)}))})),R){var Z=R[q],L=Z.normals[0].unit(),U=null,X=0;for(b=1;b<Z.normals.length;b++){var Y=Z.normals[b].unit(),W=L.cross(Y).length();W>.05&&W>X&&(X=W,U=Y)}U||(U=L.randomNonParallelVector());var H=L.cross(U).unit(),J=H.cross(L),K=c.sphere({center:Z.pos,radius:t,resolution:a,axes:[L,H,J]});u=u.unionSub(K,!1,!1)}return u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(2),i=n(8);t.expandedShellOfCAG=function(e,t,s){var a=n(10);(s=s||8)<4&&(s=4);var l=[],u={},c=e.canonicalized();for(var h in c.sides.map((function(e){var n=e.vertex1.pos.minus(e.vertex0.pos),o=n.length();if(o>r.EPS){var s=(n=n.times(1/o)).normal().times(t),a=[e.vertex1.pos.plus(s),e.vertex1.pos.minus(s),e.vertex0.pos.minus(s),e.vertex0.pos.plus(s)],c=i.fromPoints(a);l.push(c);for(var h=0;h<2;h++){var f=0===h?e.vertex0.pos:e.vertex1.pos,p=0===h?e.vertex1.pos:e.vertex0.pos,d=f.x+" "+f.y;d in u||(u[d]=[]),u[d].push({p1:f,p2:p})}}})),u){var f=u[h],p=void 0,d=void 0,g=f[0].p1;if(2===f.length){var m=f[0].p2,v=f[1].p2;if(p=m.minus(g).angleDegrees(),(d=v.minus(g).angleDegrees())<p&&(d+=360),d>=p+360&&(d-=360),d<p+180){var y=d;d=p+360,p=y}p+=90,d-=90}else p=0,d=360;var w=d>p+359.999;if(w&&(p=0,d=360),d>p+r.angleEPS){var x=[];w||x.push(g);var _=Math.round(s*(d-p)/360);_<1&&(_=1);for(var b=0;b<=_;b++){var P=p+b/_*(d-p);b===_&&(P=d);var O=g.plus(o.fromAngleDegrees(P).times(t));(!w||b>0)&&x.push(O)}var M=i.fromPointsNoCheck(x);l.push(M)}}var C=new a;return C=C.union(l)}},function(e,t){const n=function(){};n.prototype={_transform:function(e){let t=new n;return n.transformObj(this,t,e),t},_merge:function(e){let t=new n;return n.cloneObj(this,t),n.addFrom(t,e),t}},n.transformObj=function(e,t,r){for(let o in e){if("_transform"===o)continue;if("_merge"===o)continue;let i=e[o],s=i;"object"==typeof i&&("transform"in i&&"function"==typeof i.transform?s=i.transform(r):i instanceof Array?(s=[],n.transformObj(i,s,r)):i instanceof n&&(s=new n,n.transformObj(i,s,r))),t[o]=s}},n.cloneObj=function(e,t){for(let r in e){if("_transform"===r)continue;if("_merge"===r)continue;let o=e[r],i=o;if("object"==typeof o)if(o instanceof Array){i=[];for(let e=0;e<o.length;e++)i.push(o[e])}else o instanceof n&&(i=new n,n.cloneObj(o,i));t[r]=i}},n.addFrom=function(e,t){for(let r in t)"_transform"!==r&&"_merge"!==r&&(r in e&&"object"==typeof e[r]&&e[r]instanceof n&&"object"==typeof t[r]&&t[r]instanceof n?n.addFrom(e[r],t[r]):r in e||(e[r]=t[r]))},e.exports=n},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(28);t.vectorChar=function(e,t){void 0===t&&(t="?");var n=o.vectorParams(e,t),i=n.xOffset,s=n.yOffset,a=n.input,l=n.font,u=n.height,c=n.extrudeOffset,h=a.charCodeAt(0);h&&l[h]||(h=63);for(var f=r(l[h]),p=(u-c)/l.height,d=c/2,g=f.shift()*p,m=[],v=[],y=0,w=f.length;y<w;y+=2){var x=p*f[y]+i,_=p*f[y+1]+s+d;void 0===f[y]?(m.push(v),v=[],y--):v.push([x,_])}return v.length&&m.push(v),{width:g,height:u,segments:m}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(111);t.defaultsVectorParams={xOffset:0,yOffset:0,input:"?",align:"left",font:o.hersheyFont,height:14,lineSpacing:2.142857142857143,letterSpacing:1,extrudeOffset:0},t.vectorParams=function(e,n){return void 0===n&&(n="?"),r(r(r({},t.defaultsVectorParams),{input:n}),"string"==typeof e?{input:e}:e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49);t.square=r.square;var o=n(80);t.circle=o.circle;var i=n(81);t.polygon=i.polygon;var s=n(82);t.triangle=s.triangle;var a=n(83);t.cube=a.cube;var l=n(96);t.sphere=l.sphere;var u=n(41);t.geodesicSphere=u.geodesicSphere;var c=n(97);t.cylinder=c.cylinder;var h=n(98);t.torus=h.torus;var f=n(42);t.polyhedron=f.polyhedron},function(e,t,n){const r=n(10),{fromPoints:o}=n(8);function i(e){const t=o(e);this.sides=t.sides}i.prototype=r.prototype,e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(52);t.isCAGValid=function(e){var t=[];e.isSelfIntersecting(!0)&&t.push("Self intersects");var n={};for(var o in e.sides.map((function(e){function t(e){var t=e.x+" "+e.y;t in n||(n[t]=0),n[t]++}t(e.vertex0.pos),t(e.vertex1.pos)})),n){var i=n[o];1&i&&t.push("Uneven number of sides ("+i+") for point "+o)}var s=e.area();if(s<r.areaEPS&&t.push("Area is "+s),t.length>0){var a="";throw t.map((function(e){a+=e+"\n"})),new Error(a)}},t.isSelfIntersecting=function(e,t){for(var n=e.sides.length,r=0;r<n;r++)for(var i=e.sides[r],s=r+1;s<n;s++){var a=e.sides[s];if(o.linesIntersect(i.vertex0.pos,i.vertex1.pos,a.vertex0.pos,a.vertex1.pos))return t&&(console.log("side "+r+": "+i),console.log("side "+s+": "+a)),!0}return!1},t.hasPointInside=function(e,n){var r=null,o=null,i=!1;return e.sides.forEach((function(e){r=e.vertex0.pos,o=e.vertex1.pos,t.hasPointInside.c1(n,r,o)&&t.hasPointInside.c2(n,r,o)&&(i=!i)})),i},t.hasPointInside.c1=function(e,t,n){return t.y>e.y!=n.y>e.y},t.hasPointInside.c2=function(e,t,n){return e.x<(n.x-t.x)*(e.y-t.y)/(n.y-t.y)+t.x},t.contains=function(e,n){for(var r=0,o=n.sides.length;r<o;r++)if(!t.hasPointInside(e,n.sides[r].vertex0.pos))return!1;return!0}},function(e,t,n){const{EPS:r}=n(0),o=n(33),i=n(56),{fromPolygons:s}=n(5),{fromSides:a}=n(8),l=function(e,t){if(e.isCanonicalized)return e;{const t=new o;let n=c(t,e);return n.isCanonicalized=!0,n.isRetesselated=e.isRetesselated,n.properties=e.properties,n}},u=function(e,t){if(e.isCanonicalized)return e;{let t=new i,n=h(t,e);return n.isCanonicalized=!0,n}},c=function(e,t){let n=e,r=[];return t.polygons.forEach((function(e){let t=n.getPolygon(e);t.vertices.length>=3&&r.push(t)})),s(r)},h=function(e,t){let n=e,o=t.sides.map((function(e){return n.getSide(e)})).filter((function(e){return e.length()>r}));return a(o)};e.exports=function(e,t){return e.isCanonicalized?e:"sides"in e?u(e,t):l(e,t)}},function(e,t,n){const{EPS:r}=n(0),o=n(4),i=n(34),s=function(){this.vertexfactory=new i(5,r),this.planefactory=new i(4,r),this.polygonsharedfactory={}};s.prototype={getPolygonShared:function(e){let t=e.getHash();return t in this.polygonsharedfactory?this.polygonsharedfactory[t]:(this.polygonsharedfactory[t]=e,e)},getVertex:function(e){let t=[e.pos._x,e.pos._y,e.pos._z,e.uv._x,e.uv._y];return this.vertexfactory.lookupOrCreate(t,(function(t){return e}))},getPlane:function(e){let t=[e.normal._x,e.normal._y,e.normal._z,e.w];return this.planefactory.lookupOrCreate(t,(function(t){return e}))},getPolygon:function(e){let t=this.getPlane(e.plane),n=this.getPolygonShared(e.shared),r=this,i=e.vertices.map((function(e){return r.getVertex(e)})),s=[];if(i.length>0){let e=i[i.length-1].getTag();i.forEach((function(t){let n=t.getTag();n!==e&&s.push(t),e=n}))}return s.length<3&&(s=[]),new o(s,n,t)}},e.exports=s},function(e,t){const n=function(e,t){this.lookuptable={},this.multiplier=1/t};n.prototype={lookupOrCreate:function(e,t){let n="",r=this.multiplier;if(e.forEach((function(e){let t=Math.round(e*r);n+=t+"/"})),n in this.lookuptable)return this.lookuptable[n];{let o=t(e),i=e.map((function(e){let t=Math.floor(e*r);return[t+"/",t+1+"/"]})),s=1<<e.length;for(let e=0;e<s;++e){let t=e;n="",i.forEach((function(e){n+=e[1&t],t>>=1})),this.lookuptable[n]=o}return o}}},e.exports=n},function(e,t,n){const r=n(33),o=n(57),{fromPolygons:i}=n(5);e.exports=function(e){if(e.isRetesselated)return e;{let t={},n=e.isCanonicalized,s=new r;e.polygons.map((function(e){let r=e.plane,o=e.shared;n||(r=s.getPlane(r),o=s.getPolygonShared(o));let i=r.getTag()+"/"+o.getTag();i in t?t[i].push(e):t[i]=[e]}));let a=[];for(let e in t){let n=t[e];if(n.length<2)a=a.concat(n);else{let e=[];o(n,e),a=a.concat(e)}}let l=i(a);return l.isRetesselated=!0,l.properties=e.properties,l}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(1),i=n(13).Connector,s=n(8).fromPoints,a=n(2);t.getTransformationAndInverseTransformationToFlatLying=function(e){if(0===e.polygons.length){var t=new r;return[t,t]}var n=e.canonicalized(),s={};n.polygons.map((function(e){s[e.plane.getTag()]=e.plane}));var a=new o(1,0,0),l=new o(0,1,0),u=new o(0,0,1),c=new i([0,0,0],[0,0,-1],a),h=new i([0,0,0],[0,0,-1],l),f=!0,p=0,d=0,g=void 0,m=void 0;for(var v in s){var y,w=s[v],x=w.normal.times(w.w),_=void 0,b=void 0;if(w.normal.cross(a).length()>w.normal.cross(l).length())_=(y=new i(x,w.normal,a)).getTransformationTo(c,!1,0),b=c.getTransformationTo(y,!1,0);else _=(y=new i(x,w.normal,l)).getTransformationTo(h,!1,0),b=h.getTransformationTo(y,!1,0);var P=n.transform(_),O=-w.normal.dot(u),M=P.getBounds(),C=M[1].z-M[0].z,A=f;if(A||(C<p||C===p&&O>d)&&(A=!0),A){var T=new o([-.5*(M[1].x+M[0].x),-.5*(M[1].y+M[0].y),-M[0].z]);p=C,d=O,g=_=_.multiply(r.translation(T)),m=b=r.translation(T.negated()).multiply(b)}f=!1}return[g,m]},t.getTransformationToFlatLying=function(e){return e.getTransformationAndInverseTransformationToFlatLying()[0]},t.lieFlat=function(e){var t=e.getTransformationToFlatLying();return e.transform(t)},t.overCutInsideCorners=function(e,t){var n=e.canonicalized(),r={};n.sides.map((function(e){e.vertex0.getTag()in r||(r[e.vertex0.getTag()]={pos:e.vertex0.pos,from:[],to:[]}),r[e.vertex0.getTag()].to.push(e.vertex1.pos),e.vertex1.getTag()in r||(r[e.vertex1.getTag()]={pos:e.vertex1.pos,from:[],to:[]}),r[e.vertex1.getTag()].from.push(e.vertex0.pos)}));var o=[];for(var i in r){var l=r[i];if(1===l.from.length&&1===l.to.length){var u=l.from[0],c=l.pos,h=l.to[0],f=c.minus(u).unit(),p=h.minus(c).unit();if(f.cross(p)<.001){var d=p.angleRadians()-f.angleRadians()+Math.PI;d<0?d+=2*Math.PI:d>=2*Math.PI&&(d-=2*Math.PI);for(var g=p.minus(f).unit(),m=30/180*Math.PI,v=t/Math.cos(m/2),y=c.plus(g.times(v)),w=d+g.angleRadians(),x=2*(Math.PI-d),_=2*Math.ceil(x/m/2),b=[y],P=0;P<=_;P++){var O=w+P/_*x,M=a.fromAngleRadians(O).times(v).plus(y);b.push(M)}o.push(s(b))}}}return n.subtract(o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(14).parseOptionAsBool;t.extrudeInOrthonormalBasis=function(e,t,n,i){if(!(t instanceof r))throw new Error("extrudeInPlane: the first parameter should be a OrthoNormalBasis");var s=e.extrude({offset:[0,0,n]});o(i,"symmetrical",!1)&&(s=s.translate([0,0,-n/2]));var a=t.getInverseProjectionMatrix();return s=s.transform(a)}},function(e,t,n){const r=n(70);e.exports=function(e,t){e=Object.assign({},{axes:[!0,!0,!0],center:[0,0,0]},e);const{axes:n,center:o}=e,i=(t=r(t)).map((function(e){let t=e.getBounds(),r=[0,0,0];return n[0]&&(r[0]=o[0]-(t[0].x+(t[1].x-t[0].x)/2)),n[1]&&(r[1]=o[1]-(t[0].y+(t[1].y-t[0].y)/2)),n[2]&&(r[2]=o[2]-(t[0].z+(t[1].z-t[0].z)/2)),e.translate(r)}));return 1===i.length?i[0]:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71);t.expand=r.expand;var o=n(72);t.contract=o.contract;var i=n(25);t.expandedShellOfCAG=i.expandedShellOfCAG;var s=n(24);t.expandedShellOfCCSG=s.expandedShellOfCCSG},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(93),o=n(8),i=n(3);t.hull=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=[],s=e;s[0].length&&(s=s[0]);for(var a={},l=0;l<s.length;l++){var u=s[l];if(!i.isCAG(u))throw new Error("ERROR: hull() accepts only 2D forms / CAG");for(var c=0;c<u.sides.length;c++){var h=u.sides[c].vertex0.pos.x,f=u.sides[c].vertex0.pos.y;a[h+","+f]||(n.push({x:h,y:f}),a[h+","+f]++)}}var p=new r.ConvexHull;p.compute(n);var d=p.getIndices();if(d&&d.length>0){var g=[];for(l=0;l<d.length;l++)g.push(n[d[l]]);return o.fromPoints(g)}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(42),i=n(16),s={r:1,fn:5},a=[[.850651,0,-.525731],[.850651,-0,.525731],[-.850651,-0,.525731],[-.850651,0,-.525731],[0,-.525731,.850651],[0,.525731,.850651],[0,.525731,-.850651],[0,-.525731,-.850651],[-.525731,-.850651,-0],[.525731,-.850651,-0],[.525731,.850651,0],[-.525731,.850651,0]],l=[[0,9,1],[1,10,0],[6,7,0],[10,6,0],[7,9,0],[5,1,4],[4,1,9],[5,10,1],[2,8,3],[3,11,2],[2,5,4],[4,8,2],[2,11,5],[3,7,6],[6,11,3],[8,7,3],[9,8,4],[11,10,5],[10,11,6],[8,9,7]],u=function(e,t,n){for(var r=1-n,o=[],i=0;i<3;i++)o[i]=e[i]*r+t[i]*n;return o},c=function(e,t,n){for(var r=e[0],o=e[1],i=e[2],s=n,a=[],l=[],c=0;c<t;c++)for(var h=0;h<t-c;h++){var f=c/t,p=(c+1)/t,d=h/(t-c),g=(h+1)/(t-c),m=t-c-1?h/(t-c-1):1,v=[];v[0]=u(u(r,o,d),i,f),v[1]=u(u(r,o,g),i,f),v[2]=u(u(r,o,m),i,p);for(var y=0;y<3;y++)for(var w=Math.sqrt(v[y][0]*v[y][0]+v[y][1]*v[y][1]+v[y][2]*v[y][2]),x=0;x<3;x++)v[y][x]/=w;if(a.push(v[0],v[1],v[2]),l.push([s,s+1,s+2]),s+=3,h<t-c-1){var _=t-c-1?(h+1)/(t-c-1):1;v[0]=u(u(r,o,g),i,f),v[1]=u(u(r,o,_),i,p),v[2]=u(u(r,o,m),i,p);for(y=0;y<3;y++)for(w=Math.sqrt(v[y][0]*v[y][0]+v[y][1]*v[y][1]+v[y][2]*v[y][2]),x=0;x<3;x++)v[y][x]/=w;a.push(v[0],v[1],v[2]),l.push([s,s+1,s+2]),s+=3}}return{points:a,triangles:l,offset:s}};t.geodesicSphere=function(e){for(var t=r(r({},s),e),n=t.r,u=t.fn,h=Math.max(1,Math.floor(u/6)),f=[],p=[],d=0,g=0;g<l.length;g++){var m=c([a[l[g][0]],a[l[g][1]],a[l[g][2]]],h,d);f=f.concat(m.points),p=p.concat(m.triangles),d=m.offset}return i.scale(n,o.polyhedron({points:f,triangles:p}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(9).CSG;var r=n(4),o=n(1),i=n(7);t.polyhedron=function(e){for(var t=[],s=e.triangles||e.polygons,a=e.colors||null,l=0;l<s.length;l++){for(var u=[],c=0;c<s[l].length;c++)u[c]=e.points[s[l][c]];var h=[];for(c=s[l].length-1;c>=0;c--)h.push(new i(new o(u[c][0],u[c][1],u[c][2])));var f=r.defaultShared;a&&a[l]&&(f=r.Shared.fromColor(a[l])),t.push(new r(h,f))}return(0,n(5).fromPolygons)(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(101);t.css2rgb=function(e){var t=r.cssColors3ub[e.toLowerCase()];return[t[0]/255,t[1]/255,t[2]/255]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hue2rgb=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={x:0,y:0};t.translateLine=function(e,t){for(var n=r(r({},o),e),i=n.x,s=n.y,a=t.segments,l=0,u=a.length;l<u;l++)for(var c=a[l],h=0,f=c.length;h<f;h++){var p=c[h];c[h]=[p[0]+i,p[1]+s]}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),o=n(27),i=n(45);t.vectorText=function(e,t){void 0===t&&(t="?");for(var n=r.vectorParams(e,t),s=n.xOffset,a=n.yOffset,l=n.input,u=n.font,c=n.height,h=n.align,f=n.extrudeOffset,p=n.lineSpacing,d=n.letterSpacing,g=[s,a],m=g[0],v=g[1],y={width:0,segments:[]},w=[],x=[],_=0,b=m,P=function(){w.push(y),_=Math.max(_,y.width),y={width:0,segments:[]}},O=0,M=l.length;O<M;O++){var C=l[O],A=o.vectorChar({xOffset:m,yOffset:v,font:u,height:c,extrudeOffset:f},C);if("\n"!==C){var T=A.width*d;y.width+=T,m+=T," "!==C&&(y.segments=y.segments.concat(A.segments))}else m=b,v-=A.height*p,P()}for(y.segments.length&&P(),O=0,M=w.length;O<M;O++){if(y=w[O],_>y.width){var S=_-y.width;"right"===h?y=i.translateLine({x:S},y):"center"===h&&(y=i.translateLine({x:S/2},y))}x=x.concat(y.segments)}return x}},function(e,t,n){e.exports=n(48)},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=n(29);t.color=n(99),t.primitives2d={circle:o.circle,square:o.square,polygon:o.polygon,triangle:o.triangle},t.primitives3d={cube:o.cube,sphere:o.sphere,geodesicSphere:o.geodesicSphere,cylinder:o.cylinder,torus:o.torus,polyhedron:o.polyhedron},t.booleanOps=n(22),t.transformations=n(16),t.extrusions=n(23),t.maths=n(108),t.text=n(109),t.CAG=(r=n(9)).CAG,t.CSG=r.CSG,t.isCAG=r.isCAG,t.isCSG=r.isCSG,t.version={build:"0.8.0",date:"2020-05-05T09:24:35.494Z",stamp:1588670675}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=n(9).CAG,s={center:!1,size:[1,1]};t.square=function(e){var t=r(r({},s),"number"==typeof e?{size:[e,e]}:Array.isArray(e)?{size:o(e)}:e),n=t.center,a=t.size,l="number"==typeof a?[a/2,a/2]:[a[0]/2,a[1]/2],u=l[0],c=l[1],h=n?[0,0]:[u,c];return i.rectangle({center:h,radius:[u,c]})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(1),i=n(6);t.addTransformationMethodsToPrototype=function(e){e.mirrored=function(e){return this.transform(r.mirroring(e))},e.mirroredX=function(){var e=new i(o.Create(1,0,0),0);return this.mirrored(e)},e.mirroredY=function(){var e=new i(o.Create(0,1,0),0);return this.mirrored(e)},e.mirroredZ=function(){var e=new i(o.Create(0,0,1),0);return this.mirrored(e)},e.translate=function(e){return this.transform(r.translation(e))},e.scale=function(e){return this.transform(r.scaling(e))},e.rotateX=function(e){return this.transform(r.rotationX(e))},e.rotateY=function(e){return this.transform(r.rotationY(e))},e.rotateZ=function(e){return this.transform(r.rotationZ(e))},e.rotate=function(e,t,n){return this.transform(r.rotation(e,t,n))},e.rotateEulerAngles=function(e,t,n,i){i=i||[0,0,0];var s=r.rotationZ(e),a=r.rotationX(t),l=r.rotationZ(n),u=r.translation(new o(i));return this.transform(l.multiply(a).multiply(s).multiply(u))},e.rotateEulerXYZ=function(e,t,n,i){i=i||[0,0,0];var s=r.rotationX(e),a=r.rotationY(t),l=r.rotationZ(n),u=r.translation(new o(i));return this.transform(l.multiply(a).multiply(s).multiply(u))}},t.addCenteringToPrototype=function(e,t){e.center=function(e){(e=Array.prototype.map.call(arguments,(function(e){return e}))).length||(e=t.slice());var n=this.getBounds();return this.translate(t.map((function(t){return e.indexOf(t)>-1?-(n[0][t]+n[1][t])/2:0})))}}},function(e,t,n){const{_CSGDEBUG:r,EPS:o}=n(0),i=(n(7),n(4));const s=function(){this.parent=null,this.children=[],this.polygon=null,this.removed=!1};s.prototype={addPolygons:function(e){if(!this.isRootNode())throw new Error("Assertion failed");let t=this;e.map((function(e){t.addChild(e)}))},remove:function(){if(!this.removed){if(this.removed=!0,r){if(this.isRootNode())throw new Error("Assertion failed");if(this.children.length)throw new Error("Assertion failed")}let e=this.parent.children,t=e.indexOf(this);if(t<0)throw new Error("Assertion failed");e.splice(t,1),this.parent.recursivelyInvalidatePolygon()}},isRemoved:function(){return this.removed},isRootNode:function(){return!this.parent},invert:function(){if(!this.isRootNode())throw new Error("Assertion failed");this.invertSub()},getPolygon:function(){if(!this.polygon)throw new Error("Assertion failed");return this.polygon},getPolygons:function(e){let t,n,r,o,i=[this],s=[i];for(t=0;t<s.length;++t)for(i=s[t],n=0,r=i.length;n<r;n++)o=i[n],o.polygon?e.push(o.polygon):s.push(o.children)},splitByPlane:function(e,t,n,r,o){if(this.children.length){let i,s,a,l,u,c=[this.children];for(i=0;i<c.length;i++)for(u=c[i],s=0,a=u.length;s<a;s++)l=u[s],l.children.length?c.push(l.children):l._splitByPlane(e,t,n,r,o)}else this._splitByPlane(e,t,n,r,o)},_splitByPlane:function(e,t,n,r,s){let a=this.polygon;if(a){let l=a.boundingSphere(),u=l[1]+o,c=e.normal,h=l[0],f=c.dot(h)-e.w;if(f>u)r.push(this);else if(f<-u)s.push(this);else{let l=function(e,t){let n={type:null,front:null,back:null},r=e.normal,s=t.vertices,a=s.length;if(t.plane.equals(e))n.type=0;else{let h=e.w,f=!1,p=!1,d=[],g=-o;for(let e=0;e<a;e++){let t=r.dot(s[e].pos)-h,n=t<0;d.push(n),t>o&&(f=!0),t<g&&(p=!0)}if(f||p)if(p)if(f){n.type=4;let r=[],h=[],f=d[0];for(let t=0;t<a;t++){let n=s[t],o=t+1;o>=a&&(o=0);let i=d[o];if(f===i)f?h.push(n):r.push(n);else{let t=n.pos,i=s[o].pos,a=(l=t,u=i,c=e.splitLineBetweenPoints(t,i),l.distanceTo(c)/l.distanceTo(u)),p=n.interpolate(s[o],a);f?(h.push(n),h.push(p),r.push(p)):(r.push(n),r.push(p),h.push(p))}f=i}let p=o*o;if(h.length>=3){let e=h[h.length-1];for(let t=0;t<h.length;t++){let n=h[t];n.pos.distanceToSquared(e.pos)<p&&(h.splice(t,1),t--),e=n}}if(r.length>=3){let e=r[r.length-1];for(let t=0;t<r.length;t++){let n=r[t];n.pos.distanceToSquared(e.pos)<p&&(r.splice(t,1),t--),e=n}}r.length>=3&&(n.front=new i(r,t.shared,t.plane)),h.length>=3&&(n.back=new i(h,t.shared,t.plane))}else n.type=3;else n.type=2;else{let e=r.dot(t.plane.normal);n.type=e>=0?0:1}}var l,u,c;return n}(e,a);switch(l.type){case 0:t.push(this);break;case 1:n.push(this);break;case 2:r.push(this);break;case 3:s.push(this);break;case 4:if(l.front){let e=this.addChild(l.front);r.push(e)}if(l.back){let e=this.addChild(l.back);s.push(e)}}}}},addChild:function(e){let t=new s;return t.parent=this,t.polygon=e,this.children.push(t),t},invertSub:function(){let e,t,n,r,o=[this],i=[o];for(e=0;e<i.length;e++)for(o=i[e],t=0,n=o.length;t<n;t++)r=o[t],r.polygon&&(r.polygon=r.polygon.flipped()),i.push(r.children)},recursivelyInvalidatePolygon:function(){let e=this;for(;e.polygon;)e.polygon=null,e.parent&&(e=e.parent)}};const a=function(e){this.polygonTree=new s,this.rootnode=new l(null),e&&this.addPolygons(e)};a.prototype={invert:function(){this.polygonTree.invert(),this.rootnode.invert()},clipTo:function(e,t){t=!!t,this.rootnode.clipTo(e,t)},allPolygons:function(){let e=[];return this.polygonTree.getPolygons(e),e},addPolygons:function(e){let t=this,n=e.map((function(e){return t.polygonTree.addChild(e)}));this.rootnode.addPolygonTreeNodes(n)}};const l=function(e){this.plane=null,this.front=null,this.back=null,this.polygontreenodes=[],this.parent=e};l.prototype={invert:function(){let e,t=[this];for(let n=0;n<t.length;n++){e=t[n],e.plane&&(e.plane=e.plane.flipped()),e.front&&t.push(e.front),e.back&&t.push(e.back);let r=e.front;e.front=e.back,e.back=r}},clipPolygons:function(e,t){let n,r={node:this,polygontreenodes:e},o=[];do{if(n=r.node,e=r.polygontreenodes,n.plane){let r=[],i=[],s=t?r:i,a=n.plane,l=e.length;for(let t=0;t<l;t++){let n=e[t];n.isRemoved()||n.splitByPlane(a,s,r,i,r)}n.front&&i.length>0&&o.push({node:n.front,polygontreenodes:i});let u=r.length;if(n.back&&u>0)o.push({node:n.back,polygontreenodes:r});else for(let e=0;e<u;e++)r[e].remove()}r=o.pop()}while(void 0!==r)},clipTo:function(e,t){let n=this,r=[];do{n.polygontreenodes.length>0&&e.rootnode.clipPolygons(n.polygontreenodes,t),n.front&&r.push(n.front),n.back&&r.push(n.back),n=r.pop()}while(void 0!==n)},addPolygonTreeNodes:function(e){let t,n={node:this,polygontreenodes:e},r=[];do{if(t=n.node,0===(e=n.polygontreenodes).length){n=r.pop();continue}let o=t;if(!t.plane){let n=e[0].getPolygon().plane;t.plane=n}let i=[],s=[];for(let t=0,n=e.length;t<n;++t)e[t].splitByPlane(o.plane,o.polygontreenodes,s,i,s);i.length>0&&(t.front||(t.front=new l(t)),r.push({node:t.front,polygontreenodes:i})),s.length>0&&(t.back||(t.back=new l(t)),r.push({node:t.back,polygontreenodes:s})),n=r.pop()}while(void 0!==n)},getParentPlaneNormals:function(e,t){t>0&&this.parent&&(e.push(this.parent.plane.normal),this.parent.getParentPlaneNormals(e,t-1))}},e.exports=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(3);t.linesIntersect=function(e,t,n,i){if(t.equals(n)||i.equals(e)){if(i.minus(n).unit().plus(t.minus(e).unit()).length()<r.EPS)return!0}else{var s=t.minus(e),a=i.minus(n);if(Math.abs(s.cross(a))<1e-9)return!1;var l=o.solve2Linear(-s.x,a.x,-s.y,a.y,e.x-n.x,e.y-n.y);if(l[0]>1e-6&&l[0]<.999999&&l[1]>1e-5&&l[1]<.999999)return!0}return!1}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3);t.union=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,i={extrude2d:!1},s=r({},i),a=0,l=e;l[0].length&&(l=l[0]),"extrude2d"in l[0]&&(s=Object.assign({},i,l[0]),n=l[a++]),n=l[a++],"object"==typeof l[a]&&o.isCAG(l[a])&&s.extrude2d&&(n=l[a].extrude({offset:[0,0,.1]}));for(;a<l.length;a++){var u=l[a];"object"==typeof l[a]&&o.isCAG(l[a])&&s.extrude2d&&(u=l[a].extrude({offset:[0,0,.1]})),n=n.union(u)}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.difference=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=0,i=t;for(i[0].length&&(i=i[0]),e=i[o++];o<i.length;o++)e=r.isCAG(i[o])?e.subtract(i[o]):e.subtract(i[o].setColor(1,1,0));return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.intersection=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=0,i=t;for(i[0].length&&(i=i[0]),e=i[o++];o<i.length;o++)e=r.isCAG(i[o])?e.intersect(i[o]):e.intersect(i[o].setColor(1,1,0));return e}},function(e,t,n){const r=n(34),{EPS:o}=n(0),i=n(18),s=function(){this.vertexfactory=new r(2,o)};s.prototype={getVertex:function(e){let t=[e.pos._x,e.pos._y];return this.vertexfactory.lookupOrCreate(t,(function(t){return e}))},getSide:function(e){let t=this.getVertex(e.vertex0),n=this.getVertex(e.vertex1);return new i(t,n)}},e.exports=s},function(e,t,n){const{EPS:r}=n(0),o=n(12),{interpolateBetween2DPointsForY:i,insertSorted:s,fnNumberSort:a}=n(3),l=n(7),u=n(2),c=n(21),h=n(4),f=function(e,t,n){return e.distanceTo(n)/e.distanceTo(t)};e.exports=function(e,t){let n=e.length;if(n>0){let p=e[0].plane,d=e[0].shared,g=new o(p),m=[],v=[],y=[],w={},x={},_={},b=1/r*10;for(let t=0;t<n;t++){let n=e[t],r=[],o=[],i=n.vertices.length,s=-1;if(i>0){let e,a,l;for(let c=0;c<i;c++){let i,h=g.to2D(n.vertices[c].pos),f=n.vertices[c].uv,p=Math.floor(h.y*b);p in _?i=_[p]:p+1 in _?i=_[p+1]:p-1 in _?i=_[p-1]:(i=h.y,_[p]=h.y),h=u.Create(h.x,i),r.push(h),o.push(f);let d=h.y;(0===c||d<e)&&(e=d,s=c),(0===c||d>a)&&(a=d,l=c),d in x||(x[d]={}),x[d][t]=!0}e>=a?(r=[],o=[],i=0,s=-1):(e in w||(w[e]=[]),w[e].push(t))}r.reverse(),o.reverse(),s=i-s-1,m.push(r),v.push(o),y.push(s)}let P=[];for(let e in x)P.push(e);P.sort(a);let O=[],M=[];for(let e=0;e<P.length;e++){let n,o=[],a=P[e],_=Number(a),b=x[a];for(let e=0;e<O.length;++e){let t=O[e],n=t.polygonindex;if(b[n]){let r=m[n],o=v[n],i=r.length,s=t.leftvertexindex,a=t.rightvertexindex;for(;;){let e=s+1;if(e>=i&&(e=0),r[e].y!==_)break;s=e}let l=a-1;if(l<0&&(l=i-1),r[l].y===_&&(a=l),s!==t.leftvertexindex&&s===a)O.splice(e,1),--e;else{t.leftvertexindex=s,t.rightvertexindex=a,t.topleft=r[s],t.topleftuv=o[s],t.topright=r[a],t.toprightuv=o[a];let e=s+1;e>=i&&(e=0),t.bottomleft=r[e],t.bottomleftuv=o[e];let n=a-1;n<0&&(n=i-1),t.bottomright=r[n],t.bottomrightuv=o[n]}}}if(e>=P.length-1)O=[],n=null;else{n=Number(P[e+1]);let t=.5*(_+n),r=w[a];for(let e in r){let n=r[e],o=m[n],a=v[n],l=o.length,u=y[n],c=u;for(;;){let e=c+1;if(e>=l&&(e=0),o[e].y!==_)break;if(e===u)break;c=e}let h=u;for(;;){let e=h-1;if(e<0&&(e=l-1),o[e].y!==_)break;if(e===c)break;h=e}let f=c+1;f>=l&&(f=0);let p=h-1;p<0&&(p=l-1);let d={polygonindex:n,leftvertexindex:c,rightvertexindex:h,topleft:o[c],topleftuv:a[c],topright:o[h],toprightuv:a[h],bottomleft:o[f],bottomleftuv:a[f],bottomright:o[p],bottomrightuv:a[p]};s(O,d,(function(e,n){let r=i(e.topleft,e.bottomleft,t),o=i(n.topleft,n.bottomleft,t);return r>o?1:r<o?-1:0}))}}for(let e in O){let t=O[e],s=(m[t.polygonindex].length,i(t.topleft,t.bottomleft,_)),a=u.Create(s,_),l=t.topleftuv.lerp(t.bottomleftuv,f(t.topleft,t.bottomleft,a));s=i(t.topright,t.bottomright,_);let h=u.Create(s,_),p=t.toprightuv.lerp(t.bottomrightuv,f(t.topright,t.bottomright,h));s=i(t.topleft,t.bottomleft,n);let d=u.Create(s,n),g=t.topleftuv.lerp(t.bottomleftuv,f(t.topleft,t.bottomleft,d));s=i(t.topright,t.bottomright,n);let v=u.Create(s,n),y={topleft:a,topleftuv:l,topright:h,toprightuv:p,bottomleft:d,bottomleftuv:g,bottomright:v,bottomrightuv:t.toprightuv.lerp(t.bottomrightuv,f(t.topright,t.bottomright,v)),leftline:c.fromPoints(a,d),rightline:c.fromPoints(v,h)};if(o.length>0){let e=o[o.length-1],t=y.topleft.distanceTo(e.topright),n=y.bottomleft.distanceTo(e.bottomright);t<r&&n<r&&(y.topleft=e.topleft,y.topleftuv=e.topleftuv,y.leftline=e.leftline,y.bottomleft=e.bottomleft,y.bottomleftuv=e.bottomleftuv,o.splice(o.length-1,1))}o.push(y)}if(e>0){let e={},n={};for(let t=0;t<o.length;t++){let i=o[t];for(let t=0;t<M.length;t++)if(!n[t]){let o=M[t];if(o.bottomleft.distanceTo(i.topleft)<r&&o.bottomright.distanceTo(i.topright)<r){n[t]=!0;let s=i.leftline.direction().x-o.leftline.direction().x,a=i.rightline.direction().x-o.rightline.direction().x,l=Math.abs(s)<r,u=Math.abs(a)<r,c=u||a>=0;(l||s>=0)&&c&&(i.outpolygon=o.outpolygon,i.leftlinecontinues=l,i.rightlinecontinues=u,e[t]=!0);break}}}for(let n=0;n<M.length;n++)if(!e[n]){let e=M[n];e.outpolygon.rightpoints.push(e.bottomright),e.outpolygon.rightuvcoordinates.push(e.bottomrightuv),e.bottomright.distanceTo(e.bottomleft)>r&&(e.outpolygon.leftpoints.push(e.bottomleft),e.outpolygon.leftuvcoordinates.push(e.bottomleftuv)),e.outpolygon.leftpoints.reverse(),e.outpolygon.leftuvcoordinates.reverse();let o=e.outpolygon.rightpoints.concat(e.outpolygon.leftpoints),i=e.outpolygon.rightuvcoordinates.concat(e.outpolygon.leftuvcoordinates),s=[];o.map((function(e,t){let n=g.to3D(e),r=l.fromPosAndUV(n,i[t]);s.push(r)}));let a=new h(s,d,p);t.push(a)}}for(let e=0;e<o.length;e++){let t=o[e];t.outpolygon?(t.leftlinecontinues||(t.outpolygon.leftpoints.push(t.topleft),t.outpolygon.leftuvcoordinates.push(t.topleftuv)),t.rightlinecontinues||(t.outpolygon.rightpoints.push(t.topright),t.outpolygon.rightuvcoordinates.push(t.toprightuv))):(t.outpolygon={leftpoints:[],leftuvcoordinates:[],rightpoints:[],rightuvcoordinates:[]},t.outpolygon.leftpoints.push(t.topleft),t.outpolygon.leftuvcoordinates.push(t.topleftuv),t.topleft.distanceTo(t.topright)>r&&(t.outpolygon.rightpoints.push(t.topright),t.outpolygon.rightuvcoordinates.push(t.toprightuv)))}M=o}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.area=function(e){var t=0;return e.sides.map((function(e){t+=e.vertex0.pos.cross(e.vertex1.pos)})),t*=.5},t.getBounds=function(e){var t,n=t=0===e.sides.length?new r(0,0):e.sides[0].vertex0.pos;return e.sides.map((function(e){t=(t=t.min(e.vertex0.pos)).min(e.vertex1.pos),n=(n=n.max(e.vertex0.pos)).max(e.vertex1.pos)})),[t,n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(37);t.extrudeInPlane=function(e,t,n,i,s){return o.extrudeInOrthonormalBasis(e,r.GetCartesian(t,n),i,s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(14),i=o.parseOptionAs3DVector,s=o.parseOptionAsFloat,a=o.parseOptionAsInt,l=n(5),u=n(13).Connector,c=n(1);t.extrude=function(e,t){var o=n(15);if(0===e.sides.length)return new o;var h=i(t,"offset",[0,0,1]),f=s(t,"twistangle",0),p=a(t,"twiststeps",r.defaultResolution3D);if(0===h.z)throw new Error("offset cannot be orthogonal to Z axis");(0===f||p<1)&&(p=1);var d=c.Create(0,1,0),g=[];g=(g=g.concat(e._toPlanePolygons({translation:[0,0,0],normalVector:d,flipped:!(h.z<0)}))).concat(e._toPlanePolygons({translation:h,normalVector:d.rotateZ(f),flipped:h.z<0}));for(var m=0;m<p;m++){var v=new u(h.times(m/p),[0,0,h.z],d.rotateZ(m*f/p)),y=new u(h.times((m+1)/p),[0,0,h.z],d.rotateZ((m+1)*f/p));g=g.concat(e._toWallPolygons({toConnector1:v,toConnector2:y},m))}return l.fromPolygons(g)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(14),i=o.parseOptionAsFloat,s=o.parseOptionAsInt,a=n(1),l=n(13).Connector,u=n(5);t.rotateExtrude=function(e,t){void 0===t&&(t={});var n=i(t,"angle",360),o=s(t,"resolution",r.defaultResolution3D);n=n>360?n%360:n;var c=[0,0,0],h=a.Create(0,1,0),f=[0,0,1],p=[],d=new l(c,h,f);if(n>0&&n<360){var g=new l(c,h.rotateZ(-n),f);p=(p=p.concat(e._toPlanePolygons({toConnector:d,flipped:!0}))).concat(e._toPlanePolygons({toConnector:g}))}for(var m,v=d,y=n/o,w=y;w<=n+r.EPS;w+=y)m=new l(c,h.rotateZ(-w),f),p=p.concat(e._toWallPolygons({toConnector1:v,toConnector2:m},0)),v=m;return u.fromPolygons(p).reTesselated()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linear_extrude=function(e,t){var n=Object.assign({},{height:1,slices:10,twist:0,center:!1},e),r=n.height,o=n.twist,i=n.slices,s=n.center,a=t.extrude({offset:[0,0,r],twistangle:o,twiststeps:i});if(!0===s){var l=a.getBounds(),u=l[1].plus(l[0]).times(-.5);a=a.translate(u)}return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(64),o=n(65),i=n(66),s=n(67),a=n(11),l=n(5),u=n(8);t.rotate_extrude=function(e,t){var n={fn:32,startAngle:0,angle:360,overflow:"cap"},c=(e=Object.assign({},n,e)).fn,h=e.startAngle,f=e.angle,p=e.overflow;if("cap"!==p)throw new Error("only capping of overflowing points is supported !");arguments.length<2&&(t=e);var d=f>0,g=d?s.clamp(h+f,0,360):s.clamp(h+f,-360,0),m=Math.max(Math.floor(Math.abs(g)/45),1,c),v=1e-5,y=i.cagToPointsArray(t),w=y.filter((function(e){return e[0]<0})),x=y.filter((function(e){return e[0]>=0})),_=w.length>0&&x.length>0;_&&"cap"===p&&(w.length>x.length?y=y.map((function(e){return[Math.min(e[0],0),e[1]]})):x.length>=w.length&&(y=y.map((function(e){return[Math.max(e[0],0),e[1]]}))));for(var b=[],P=function(e){for(var t=0;t<y.length-1;t++){var n=y[t],i=y[t+1],s=a.rotationZ((e-1)/m*f+h),l=a.rotationZ(e/m*f+h),c=o.rightMultiply1x3VectorToArray(s,[n[0],0,n[1]]),p=o.rightMultiply1x3VectorToArray(l,[n[0],0,n[1]]),g=o.rightMultiply1x3VectorToArray(s,[i[0],0,i[1]]),w=o.rightMultiply1x3VectorToArray(l,[i[0],0,i[1]]),x=!1;Math.abs(c[0]-p[0])<v&&Math.abs(g[1]-w[1])<v&&(x=!0),d?(b.push(r.polygonFromPoints([c,g,w])),x||b.push(r.polygonFromPoints([w,p,c]))):(x||b.push(r.polygonFromPoints([c,p,w])),b.push(r.polygonFromPoints([w,g,c])))}if(Math.abs(f)<360){var _=u.fromPoints(y),P=a.rotationX(90).multiply(a.rotationZ(-h)),O=_._toPlanePolygons({flipped:d}).map((function(e){return e.transform(P)})),M=a.rotationX(90).multiply(a.rotationZ(-f-h)),C=_._toPlanePolygons({flipped:!d}).map((function(e){return e.transform(M)}));b=b.concat(O).concat(C)}},O=1;O<m+1;O++)P(O);return l.fromPolygons(b).reTesselated().canonicalized()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(1),i=n(4);t.polygonFromPoints=function(e){var t=e.map((function(e){return new r(new o(e))}));return new i(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rightMultiply1x3VectorToArray=function(e,t){var n=t[0],r=t[1],o=t[2],i=n*e.elements[0]+r*e.elements[1]+o*e.elements[2]+1*e.elements[3],s=n*e.elements[4]+r*e.elements[5]+o*e.elements[6]+1*e.elements[7],a=n*e.elements[8]+r*e.elements[9]+o*e.elements[10]+1*e.elements[11],l=n*e.elements[12]+r*e.elements[13]+o*e.elements[14]+1*e.elements[15];if(1!==l){var u=1/l;i*=u,s*=u,a*=u}return[i,s,a]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cagToPointsArray=function(e){var t;return"sides"in e?(t=[],e.sides.forEach((function(e){t.push([e.vertex0.pos.x,e.vertex0.pos.y]),t.push([e.vertex1.pos.x,e.vertex1.pos.y])}))):"points"in e&&(t=e.points.map((function(e){return[e.x,e.y]}))),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20);t.rectangular_extrude=function(e,t){var n=Object.assign({},{w:1,h:1,fn:8,closed:!1,round:!0},t),o=n.w,i=n.h,s=n.fn,a=n.closed,l=n.round;return new r(e,a).rectangularExtrude(o,i,s,l)}},function(e,t,n){const r=n(20);e.exports=function(e){let t=e.canonicalized(),n={},o={};t.sides.map((function(e){let t=e.getTag();n[t]=e;let r=e.vertex0.getTag();r in o||(o[r]=[]),o[r].push(t)}));let i=[];for(;;){let e=null;for(let t in o){let n=o[t];e=n[0],n.splice(0,1),0===n.length&&delete o[t];break}if(null===e)break;let t=[],s=n[e],a=s.vertex0.getTag();for(;;){t.push(s.vertex0.pos);let e=s.vertex1.getTag();if(e===a)break;if(!(e in o))throw new Error("Area is not closed!");let r=o[e],i=-1;if(1===r.length)i=0;else{let e=null,t=s.direction().angleDegrees();for(let o=0;o<r.length;o++){let s=r[o],a=n[s].direction().angleDegrees()-t;a<-180&&(a+=360),a>=180&&(a-=360),(i<0||a>e)&&(i=o,e=a)}}let l=r[i];r.splice(i,1),0===r.length&&delete o[e],s=n[l]}t.length>0&&t.push(t.shift());let l=new r(t,!0);i.push(l)}return i}},function(e,t){e.exports=function(e){return e?e.constructor!==Array?[e]:e:[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(24),o=n(25),i=n(3);t.expand=function(e,t,n){var s;return i.isCSG(e)?(s=(s=e.union(r.expandedShellOfCCSG(e,t,n))).reTesselated()).properties=e.properties:s=e.union(o.expandedShellOfCAG(e,t,n)),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(24),o=n(25),i=n(3);t.contract=function(e,t,n){var s;return i.isCSG(e)?(s=(s=e.subtract(r.expandedShellOfCCSG(e,t,n))).reTesselated()).properties=e.properties:s=e.subtract(o.expandedShellOfCAG(e,t,n)),s}},function(e,t,n){const r=n(4),{fromPolygons:o}=n(5),{fnSortByIndex:i}=n(3),s=function(e,t,n,o){let s=t.vertices.slice(0),a=n.vertices.slice(0),l=n.shared||null;s[0].pos.equals(s[s.length-1].pos)||s.push(s[0]),a[0].pos.equals(a[a.length-1].pos)||a.push(a[0]),o&&(s=s.reverse(),a=a.reverse());let u,c=a.length-1,h=s.length-1,f=c-h,p=f>0,d=f<0,g=[];for(let e=Math.abs(f);e>0;e--)g.push({len:1/0,index:-1});if(d)for(let e=0;e<h;e++){u=s[e].pos.distanceToSquared(s[e+1].pos);for(let e=g.length-1;e>=0;e--)if(g[e].len>u){g[e].len=u,g.index=e;break}}else if(p)for(let e=0;e<c;e++){u=a[e].pos.distanceToSquared(a[e+1].pos);for(let e=g.length-1;e>=0;e--)if(g[e].len>u){g[e].len=u,g.index=e;break}}g.sort(i);let m,v,y,w=function(e,t,n,o){return new r([e,t,n],o)},x=s[0],_=a[0];for(let t=0,n=0,r=c+h;t+n<r;){if(g.length){if(p&&n===g[0].index){m=a[++n],e.push(w(m,_,x,l)),_=m,g.shift();continue}if(d&&t===g[0].index){m=s[++t],e.push(w(_,x,m,l)),x=m,g.shift();continue}}v=t<h?_.pos.distanceToSquared(s[t+1].pos):1/0,y=n<c?x.pos.distanceToSquared(a[n+1].pos):1/0,v<=y?(m=s[++t],e.push(w(_,x,m,l)),x=m):n<c&&(m=a[++n],e.push(w(m,_,x,l)),_=m)}return e};e.exports=function(e,t){let n,i=[],a=null,l=null,u=null,c=null,h=2,f=!1,p=null;if(t&&(f=Boolean(t.loop),t.numslices&&(h=t.numslices),t.callback&&(n=t.callback)),!n){let e=r.createFromPoints([[0,0,0],[1,0,0],[1,1,0],[0,1,0]]);n=function(t,n){return 0===t||1===t?e.translate([0,0,t]):null}}for(let t=0,o=h-1;t<=o;t++)if(a=n.call(e,t/o,t),a){if(!(a instanceof r))throw new Error("Polygon.solidFromSlices callback error: Polygon expected");a.checkIfConvex(),l?(null===p&&(p=l.plane.signedDistanceToPoint(a.vertices[0].pos)<0),s(i,l,a,p)):u=a,l=a}if(c=a,f){u.vertices.length===c.vertices.length&&u.vertices.every((function(e,t){return e.pos.equals(c.vertices[t].pos)}))||s(i,c,u,p)}else i.unshift(p?u:u.flipped()),i.push(p?c.flipped():c);return o(i)}},function(e,t,n){const{EPS:r}=n(0),o=n(4),i=n(6);function s(e,t,n,r,o,i){let s=r.getTag(),l=o.getTag();if(s===l)throw new Error("Assertion failed");let u=s+"/"+l;if(l+"/"+s in e)return a(e,t,n,o,r,null),null;let c={vertex0:r,vertex1:o,polygonindex:i};return u in e?e[u].push(c):e[u]=[c],s in t?t[s].push(u):t[s]=[u],l in n?n[l].push(u):n[l]=[u],u}function a(e,t,n,r,o,i){let s=r.getTag(),a=o.getTag(),l=s+"/"+a;if(!(l in e))throw new Error("Assertion failed");let u=-1,c=e[l];for(let e=0;e<c.length;e++){let t=c[e];if(t.vertex0===r&&(t.vertex1===o&&(null===i||t.polygonindex===i))){u=e;break}}if(u<0)throw new Error("Assertion failed");if(c.splice(u,1),0===c.length&&delete e[l],u=t[s].indexOf(l),u<0)throw new Error("Assertion failed");if(t[s].splice(u,1),0===t[s].length&&delete t[s],u=n[a].indexOf(l),u<0)throw new Error("Assertion failed");n[a].splice(u,1),0===n[a].length&&delete n[a]}e.exports=function(e,t){t=t.canonicalized();let n={};for(let e=0;e<t.polygons.length;e++){let r=t.polygons[e],o=r.vertices.length;if(o>=3){let t=r.vertices[0],i=t.getTag();for(let s=0;s<o;s++){let a=s+1;a===o&&(a=0);let l=r.vertices[a],u=l.getTag(),c=i+"/"+u,h=u+"/"+i;if(h in n){let e=n[h];e.splice(-1,1),0===e.length&&delete n[h]}else{let r={vertex0:t,vertex1:l,polygonindex:e};c in n?n[c].push(r):n[c]=[r]}t=l,i=u}}}let l={},u={},c={},h=!0;for(let e in n)h=!1,c[e]=!0,n[e].map((function(t){let n=t.vertex0.getTag(),r=t.vertex1.getTag();n in l?l[n].push(e):l[n]=[e],r in u?u[r].push(e):u[r]=[e]}));if(!h){let h=t.polygons.slice(0);for(;;){let e=!0;for(let t in n)e=!1,c[t]=!0;if(e)break;let t=!1;for(;;){let e=null;for(let t in c){e=t;break}if(null===e)break;let f=!0;if(e in n){let p=n[e];if(0===p.length)throw new Error("Assertion failed");let d=p[0];for(let e=0;e<2;e++){let p=0===e?d.vertex0:d.vertex1,g=0===e?d.vertex1:d.vertex0,m=p.getTag(),v=g.getTag(),y=[];0===e?m in u&&(y=u[m]):m in l&&(y=l[m]);for(let d=0;d<y.length;d++){let w=n[y[d]][0],x=0===e?w.vertex0:w.vertex1,_=0===e?w.vertex1:w.vertex0,b=x.getTag();if(_.getTag()!==m)throw new Error("Assertion failed");if(b===v){a(n,l,u,p,g,null),a(n,l,u,g,p,null),f=!1,e=2,t=!0;break}{let d=p.pos,m=g.pos,v=x.pos.minus(d),y=m.minus(d).dot(v)/v.dot(v);if(y>0&&y<1){if(d.plus(v.times(y)).distanceToSquared(m)<r*r){let r=w.polygonindex,p=h[r],d=w.vertex1.getTag(),m=-1;for(let e=0;e<p.vertices.length;e++)if(p.vertices[e].getTag()===d){m=e;break}if(m<0)throw new Error("Assertion failed");let v=p.vertices.slice(0);v.splice(m,0,g);let y=new o(v,p.shared);if(isNaN(y.plane.w)){let e=!1,t=function(t){y.vertices.forEach((function(n){e||t(n)}))};t((function(n){t((function(r){t((function(t){y.plane=i.fromPoints(n.pos,r.pos,t.pos),isNaN(y.plane.w)||(e=!0)}))}))}))}h[r]=y,a(n,l,u,w.vertex0,w.vertex1,r);let x=s(n,l,u,w.vertex0,g,r),_=s(n,l,u,g,w.vertex1,r);null!==x&&(c[x]=!0),null!==_&&(c[_]=!0),f=!1,e=2,t=!0;break}}}}}}f&&delete c[e]}if(!t)break}let f=e(h);f.properties=t.properties,f.isCanonicalized=!0,f.isRetesselated=!0,t=f}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.bounds=function(e){if(!e.cachedBoundingBox){for(var t=new r(0,0,0),n=new r(0,0,0),o=e.polygons,i=o.length,s=0;s<i;s++){var a=o[s].boundingBox();0===s?(t=a[0],n=a[1]):(t=t.min(a[0]),n=n.max(a[1]))}e.cachedBoundingBox=[t,n]}return e.cachedBoundingBox},t.volume=function(e){var t=e.toTriangles().map((function(e){return e.getTetraFeatures(["volume"])}));console.log("volume",t)},t.area=function(e){var t=e.toTriangles().map((function(e){return e.getTetraFeatures(["area"])}));console.log("area",t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),o=n(0);t.projectToOrthoNormalBasis=function(e,t){var n=[];return e.polygons.filter((function(e){return e.plane.normal.minus(t.plane.normal).lengthSquared()<o.EPS*o.EPS})).map((function(e){var r=e.projectToOrthoNormalBasis(t);r.sides.length>0&&n.push(r)})),(new r).union(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(6),i=n(2),s=n(7),a=n(4),l=n(12);t.sectionCut=function(e,t){var n=t.plane,i=t.plane.flipped();n=new o(n.normal,n.w),i=new o(i.normal,i.w+5*r.EPS);var s=e.cutByPlane(n);return(s=s.cutByPlane(i)).projectToOrthoNormalBasis(t)},t.cutByPlane=function(e,t){if(0===e.polygons.length)return new(n(15));var r=t.normal.times(t.w),o=0;e.polygons.map((function(e){e.vertices.map((function(e){var t=e.pos.distanceToSquared(r);t>o&&(o=t)}))})),o=Math.sqrt(o),o*=1.01;var u=[],c=new l(t);u.push(s.fromPosAndUV(c.to3D(new i(o,-o)),new i(o,-o))),u.push(s.fromPosAndUV(c.to3D(new i(-o,-o)),new i(-o,-o))),u.push(s.fromPosAndUV(c.to3D(new i(-o,o)),new i(-o,o))),u.push(s.fromPosAndUV(c.to3D(new i(o,o)),new i(o,o)));var h=new a(u,null,t.flipped()).extrude(t.normal.times(-o)),f=e.intersect(h);return f.properties=e.properties,f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(10);var r=n(14),o=n(0),i=n(8),s=n(2),a=n(20);t.circle=function(e){e=e||{};for(var t=r.parseOptionAs2DVector(e,"center",[0,0]),n=r.parseOptionAsFloat(e,"radius",1),a=r.parseOptionAsInt(e,"resolution",o.defaultResolution2D),l=[],u=0;u<a;u++){var c=2*Math.PI*u/a,h=s.fromAngleRadians(c).times(n).plus(t);l.push(h)}return i.fromPoints(l)},t.ellipse=function(e){e=e||{};var t=r.parseOptionAs2DVector(e,"center",[0,0]),n=r.parseOptionAs2DVector(e,"radius",[1,1]);n=n.abs();var s=r.parseOptionAsInt(e,"resolution",o.defaultResolution2D),l=new a([[t.x,t.y+n.y]]);return l=(l=(l=l.appendArc([t.x,t.y-n.y],{xradius:n.x,yradius:n.y,xaxisrotation:0,resolution:s,clockwise:!0,large:!1})).appendArc([t.x,t.y+n.y],{xradius:n.x,yradius:n.y,xaxisrotation:0,resolution:s,clockwise:!0,large:!1})).close(),i.fromPath2(l)},t.rectangle=function(e){var t,n;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("rectangle: should either give a radius and center parameter, or a corner1 and corner2 parameter");var o=r.parseOptionAs2DVector(e,"corner1",[0,0]),a=r.parseOptionAs2DVector(e,"corner2",[1,1]);t=o.plus(a).times(.5),n=a.minus(o).times(.5)}else t=r.parseOptionAs2DVector(e,"center",[0,0]),n=r.parseOptionAs2DVector(e,"radius",[1,1]);n=n.abs();var l=new s(n.x,-n.y),u=[t.plus(n),t.plus(l),t.minus(n),t.minus(l)];return i.fromPoints(u)},t.roundedRectangle=function(e){var n,i;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("roundedRectangle: should either give a radius and center parameter, or a corner1 and corner2 parameter");var a=r.parseOptionAs2DVector(e,"corner1",[0,0]),l=r.parseOptionAs2DVector(e,"corner2",[1,1]);n=a.plus(l).times(.5),i=l.minus(a).times(.5)}else n=r.parseOptionAs2DVector(e,"center",[0,0]),i=r.parseOptionAs2DVector(e,"radius",[1,1]);i=i.abs();var u=r.parseOptionAsFloat(e,"roundradius",.2),c=r.parseOptionAsInt(e,"resolution",o.defaultResolution2D),h=Math.min(i.x,i.y);h-=.1,u=Math.min(u,h),u=Math.max(0,u),i=new s(i.x-u,i.y-u);var f=t.rectangle({center:n,radius:i});return u>0&&(f=f.expand(u,c)),f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),o=n(0),i=n(5),s=n(1),a=n(7),l=n(4),u=n(13).Connector,c=n(26);t.cube=function(e){var t,n,o,h;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("cube: should either give a radius and center parameter, or a corner1 and corner2 parameter");o=r.parseOptionAs3DVector(e,"corner1",[0,0,0]),h=r.parseOptionAs3DVector(e,"corner2",[1,1,1]),t=o.plus(h).times(.5),n=h.minus(o).times(.5)}else t=r.parseOptionAs3DVector(e,"center",[0,0,0]),n=r.parseOptionAs3DVector(e,"radius",[1,1,1]);n=n.abs();var f=i.fromPolygons([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map((function(e){var r=e[0].map((function(e){var r=new s(t.x+n.x*(2*+!!(1&e)-1),t.y+n.y*(2*+!!(2&e)-1),t.z+n.z*(2*+!!(4&e)-1));return new a(r)}));return new l(r,null)})));return f.properties.cube=new c,f.properties.cube.center=new s(t),f.properties.cube.facecenters=[new u(new s([n.x,0,0]).plus(t),[1,0,0],[0,0,1]),new u(new s([-n.x,0,0]).plus(t),[-1,0,0],[0,0,1]),new u(new s([0,n.y,0]).plus(t),[0,1,0],[0,0,1]),new u(new s([0,-n.y,0]).plus(t),[0,-1,0],[0,0,1]),new u(new s([0,0,n.z]).plus(t),[0,0,1],[1,0,0]),new u(new s([0,0,-n.z]).plus(t),[0,0,-1],[1,0,0])],f},t.sphere=function(e){e=e||{};var t,n,u,h=r.parseOptionAs3DVector(e,"center",[0,0,0]),f=r.parseOptionAsFloat(e,"radius",1),p=r.parseOptionAsInt(e,"resolution",o.defaultResolution3D);"axes"in e?(t=e.axes[0].unit().times(f),n=e.axes[1].unit().times(f),u=e.axes[2].unit().times(f)):(t=new s([1,0,0]).times(f),n=new s([0,-1,0]).times(f),u=new s([0,0,1]).times(f)),p<4&&(p=4);for(var d,g=Math.round(p/4),m=[],v=0;v<=p;v++){var y=2*Math.PI*v/p,w=t.times(Math.cos(y)).plus(n.times(Math.sin(y)));if(v>0)for(var x=[],_=void 0,b=void 0,P=0;P<=g;P++){var O=.5*Math.PI*P/g,M=Math.cos(O),C=Math.sin(O);P>0&&((x=[]).push(new a(h.plus(d.times(_).minus(u.times(b))))),x.push(new a(h.plus(w.times(_).minus(u.times(b))))),P<g&&x.push(new a(h.plus(w.times(M).minus(u.times(C))))),x.push(new a(h.plus(d.times(M).minus(u.times(C))))),m.push(new l(x)),(x=[]).push(new a(h.plus(d.times(_).plus(u.times(b))))),x.push(new a(h.plus(w.times(_).plus(u.times(b))))),P<g&&x.push(new a(h.plus(w.times(M).plus(u.times(C))))),x.push(new a(h.plus(d.times(M).plus(u.times(C))))),x.reverse(),m.push(new l(x))),_=M,b=C}d=w}var A=i.fromPolygons(m);return A.properties.sphere=new c,A.properties.sphere.center=new s(h),A.properties.sphere.facepoint=h.plus(t),A},t.cylinder=function(e){var t=r.parseOptionAs3DVector(e,"start",[0,-1,0]),n=r.parseOptionAs3DVector(e,"end",[0,1,0]),s=r.parseOptionAsFloat(e,"radius",1),h=r.parseOptionAsFloat(e,"radiusEnd",s),f=r.parseOptionAsFloat(e,"radiusStart",s),p=r.parseOptionAsFloat(e,"sectorAngle",360);if(p=p>360?p%360:p,h<0||f<0)throw new Error("Radius should be non-negative");if(0===h&&0===f)throw new Error("Either radiusStart or radiusEnd should be positive");var d=r.parseOptionAsInt(e,"resolution",o.defaultResolution2D),g=n.minus(t),m=g.unit(),v=m.randomNonParallelVector().unit(),y=v.cross(m).unit(),w=new a(t),x=new a(n),_=[];function b(e,n,r){var o=n*Math.PI*p/180,i=v.times(Math.cos(o)).plus(y.times(Math.sin(o))),s=t.plus(g.times(e)).plus(i.times(r));return new a(s)}if(p>0){for(var P=0;P<d;P++){var O=P/d,M=(P+1)/d;h===f?(_.push(new l([w,b(0,O,h),b(0,M,h)])),_.push(new l([b(0,M,h),b(0,O,h),b(1,O,h),b(1,M,h)])),_.push(new l([x,b(1,M,h),b(1,O,h)]))):(f>0&&(_.push(new l([w,b(0,O,f),b(0,M,f)])),_.push(new l([b(0,O,f),b(1,O,h),b(0,M,f)]))),h>0&&(_.push(new l([x,b(1,M,h),b(1,O,h)])),_.push(new l([b(1,O,h),b(1,M,h),b(0,M,f)]))))}p<360&&(_.push(new l([w,x,b(0,0,f)])),_.push(new l([b(0,0,f),x,b(1,0,h)])),_.push(new l([w,b(0,1,f),x])),_.push(new l([b(0,1,f),b(1,1,h),x])))}var C=i.fromPolygons(_);C.properties.cylinder=new c,C.properties.cylinder.start=new u(t,m.negated(),v),C.properties.cylinder.end=new u(n,m,v);var A=t.plus(g.times(.5)),T=v.rotate(t,m,-p/2).times((f+h)/2),S=T.cross(m);return C.properties.cylinder.facepointH=new u(A.plus(T),T,m),C.properties.cylinder.facepointH90=new u(A.plus(S),S,m),C},t.roundedCylinder=function(e){var n,h=r.parseOptionAs3DVector(e,"start",[0,-1,0]),f=r.parseOptionAs3DVector(e,"end",[0,1,0]),p=r.parseOptionAsFloat(e,"radius",1),d=f.minus(h);n=Math.abs(d.x)>Math.abs(d.y)?new s(0,1,0):new s(1,0,0);var g=r.parseOptionAs3DVector(e,"normal",n),m=r.parseOptionAsInt(e,"resolution",o.defaultResolution3D);m<4&&(m=4);var v=[],y=Math.floor(.25*m);if(d.length()<o.EPS)return t.sphere({center:h,radius:p,resolution:m});for(var w,x=d.unit().times(p),_=x.cross(g).unit().times(p),b=_.cross(x).unit().times(p),P=0;P<=m;P++){var O=2*Math.PI*P/m,M=_.times(Math.cos(O)).plus(b.times(Math.sin(O)));if(P>0){var C=[];C.push(new a(h.plus(M))),C.push(new a(h.plus(w))),C.push(new a(f.plus(w))),C.push(new a(f.plus(M))),v.push(new l(C));for(var A=void 0,T=void 0,S=0;S<=y;S++){var E=.5*Math.PI*S/y,j=Math.cos(E),z=Math.sin(E);S>0&&((C=[]).push(new a(h.plus(w.times(A).minus(x.times(T))))),C.push(new a(h.plus(M.times(A).minus(x.times(T))))),S<y&&C.push(new a(h.plus(M.times(j).minus(x.times(z))))),C.push(new a(h.plus(w.times(j).minus(x.times(z))))),v.push(new l(C)),(C=[]).push(new a(f.plus(w.times(A).plus(x.times(T))))),C.push(new a(f.plus(M.times(A).plus(x.times(T))))),S<y&&C.push(new a(f.plus(M.times(j).plus(x.times(z))))),C.push(new a(f.plus(w.times(j).plus(x.times(z))))),C.reverse(),v.push(new l(C))),A=j,T=z}}w=M}var D=i.fromPolygons(v),V=x.unit(),k=_.unit();return D.properties.roundedCylinder=new c,D.properties.roundedCylinder.start=new u(h,V.negated(),k),D.properties.roundedCylinder.end=new u(f,V,k),D.properties.roundedCylinder.facepoint=h.plus(_),D},t.cylinderElliptic=function(e){var t=r.parseOptionAs3DVector(e,"start",[0,-1,0]),n=r.parseOptionAs3DVector(e,"end",[0,1,0]),s=r.parseOptionAs2DVector(e,"radius",[1,1]),h=r.parseOptionAs2DVector(e,"radiusEnd",s),f=r.parseOptionAs2DVector(e,"radiusStart",s);if(h._x<0||f._x<0||h._y<0||f._y<0)throw new Error("Radius should be non-negative");if(!(0!==h._x&&0!==h._y||0!==f._x&&0!==f._y))throw new Error("Either radiusStart or radiusEnd should be positive");var p=r.parseOptionAsInt(e,"resolution",o.defaultResolution2D),d=n.minus(t),g=d.unit(),m=g.randomNonParallelVector().unit(),v=m.cross(g).unit(),y=new a(t),w=new a(n),x=[];function _(e,n,r){var o=n*Math.PI*2,i=m.times(r._x*Math.cos(o)).plus(v.times(r._y*Math.sin(o))),s=t.plus(d.times(e)).plus(i);return new a(s)}for(var b=0;b<p;b++){var P=b/p,O=(b+1)/p;h._x===f._x&&h._y===f._y?(x.push(new l([y,_(0,P,h),_(0,O,h)])),x.push(new l([_(0,O,h),_(0,P,h),_(1,P,h),_(1,O,h)])),x.push(new l([w,_(1,O,h),_(1,P,h)]))):(f._x>0&&(x.push(new l([y,_(0,P,f),_(0,O,f)])),x.push(new l([_(0,P,f),_(1,P,h),_(0,O,f)]))),h._x>0&&(x.push(new l([w,_(1,O,h),_(1,P,h)])),x.push(new l([_(1,P,h),_(1,O,h),_(0,O,f)]))))}var M=i.fromPolygons(x);return M.properties.cylinder=new c,M.properties.cylinder.start=new u(t,g.negated(),m),M.properties.cylinder.end=new u(n,g,m),M.properties.cylinder.facepoint=t.plus(m.times(f)),M},t.roundedCube=function(e){var n,i,l,h;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("roundedCube: should either give a radius and center parameter, or a corner1 and corner2 parameter");l=r.parseOptionAs3DVector(e,"corner1",[0,0,0]),h=r.parseOptionAs3DVector(e,"corner2",[1,1,1]),n=l.plus(h).times(.5),i=h.minus(l).times(.5)}else n=r.parseOptionAs3DVector(e,"center",[0,0,0]),i=r.parseOptionAs3DVector(e,"radius",[1,1,1]);i=i.abs();var f=r.parseOptionAsInt(e,"resolution",o.defaultResolution3D);f<4&&(f=4),f%2==1&&f<8&&(f=8);var p=r.parseOptionAs3DVector(e,"roundradius",[.2,.2,.2]);p=s.Create(Math.max(p.x,.01),Math.max(p.y,.01),Math.max(p.z,.01));var d=i.minus(p);if(d.x<0||d.y<0||d.z<0)throw new Error("roundradius <= radius!");var g=t.sphere({radius:1,resolution:f});return g=g.scale(p),d.x>o.EPS&&(g=g.stretchAtPlane([1,0,0],[0,0,0],2*d.x)),d.y>o.EPS&&(g=g.stretchAtPlane([0,1,0],[0,0,0],2*d.y)),d.z>o.EPS&&(g=g.stretchAtPlane([0,0,1],[0,0,0],2*d.z)),(g=(g=g.translate([-d.x+n.x,-d.y+n.y,-d.z+n.z])).reTesselated()).properties.roundedCube=new c,g.properties.roundedCube.center=new a(n),g.properties.roundedCube.facecenters=[new u(new s([i.x,0,0]).plus(n),[1,0,0],[0,0,1]),new u(new s([-i.x,0,0]).plus(n),[-1,0,0],[0,0,1]),new u(new s([0,i.y,0]).plus(n),[0,1,0],[0,0,1]),new u(new s([0,-i.y,0]).plus(n),[0,-1,0],[0,0,1]),new u(new s([0,0,i.z]).plus(n),[0,0,1],[1,0,0]),new u(new s([0,0,-i.z]).plus(n),[0,0,-1],[1,0,0])],g},t.polyhedron=function(e){if("points"in(e=e||{})!="faces"in e)throw new Error("polyhedron needs 'points' and 'faces' arrays");var t=r.parseOptionAs3DVectorList(e,"points",[[1,1,0],[1,-1,0],[-1,-1,0],[-1,1,0],[0,0,1]]).map((function(e){return new a(e)})),n=r.parseOption(e,"faces",[[0,1,4],[1,2,4],[2,3,4],[3,0,4],[1,0,3],[2,1,3]]);n.forEach((function(e){e.reverse()}));var o=n.map((function(e){return new l(e.map((function(e){return t[e]})))}));return i.fromPolygons(o).reTesselated()}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9).CAG,i={r:1,fn:32,center:!1};t.circle=function(e){var t=r(r({},i),"number"==typeof e?{r:e}:e),n=t.r,s=t.fn,a=t.center?[0,0]:[n,n];return o.circle({center:a,radius:n,resolution:s})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(9).CAG;var r=n(8);t.polygon=function(e){var t=[];return e.paths&&e.paths.length&&e.paths[0].length?("number"!=typeof e.points[0][0]&&(e.points=e.points.reduce((function(e,t){return e.concat(t)}))),e.paths.forEach((function(n,r){t.push([]),n.forEach((function(n){return t[r].push(e.points[n])}))}))):e.paths&&e.paths.length?e.paths.forEach((function(n){return t.push(e.points[n])})):t=e.length?e:e.points,r.fromPoints(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(9).CAG;var r=n(8);t.triangle=function(){var e=arguments;return e[0]&&e[0].length&&(e=e[0]),r.fromPoints(e)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),s=n(9).CSG,a={size:1,center:!1,round:!1,radius:0,fn:8};t.cube=function(e){var t=r(r({},a),Array.isArray(e)?{size:e}:e),n=t.round,l=t.radius,u=t.fn,c=t.size,h=t.center,f=Array.isArray(c)?c:[c,c,c],p=f[0],d=f[1],g=f[2],m=(n||l)&&(l||(p+d+g)/30)||0,v=[p/2,d/2,g/2],y=m?s.roundedCube({radius:o(v),roundradius:m,resolution:u}):s.cube({radius:o(v)}),w=Array.isArray(h)?[+!h[0]*v[0],+!h[1]*v[1],+!h[2]*v[2]]:h?[0,0,0]:o(v);return w[0]||w[1]||w[2]?i.translate(w,y):y}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translate=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t.length>=1&&t[0].length?t[0]:t,o=r[0];if(r.length>1)for(var i=1;i<r.length;i++)o=o.union(r[i]);return o.translate(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scale=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t.length>=1&&t[0].length?t[0]:t,o=r[0];if(r.length>1)for(var i=1;i<r.length;i++)o=o.union(r[i]);return o.scale(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rotate=function(){var e,t,n,r=1,o=arguments;for(o[0].length?(n=o[0],t=1,o[1].length&&(o=o[1],t=0)):(r=o[0],n=o[1],t=2,o[2].length&&(o=o[2],t=0)),e=o[t++];t<o.length;t++)e=e.union(o[t]);return 1!==r?e.rotate([0,0,0],n,r):e.rotateX(n[0]).rotateY(n[1]).rotateZ(n[2])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);t.transform=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o,i=t.length>=1&&t[0].length?t[0]:t,s=i[0];if(i.length>1)for(var a=1;a<i.length;a++)s=s.union(i[a]);if(!Array.isArray(e))throw new Error("Matrix needs to be an array");return e.forEach((function(e){if(!Number.isFinite(e))throw new Error("you can only use a flat array of valid, finite numbers (float and integers)")})),o=new r(e),s.transform(o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.center=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t.length>=1&&t[0].length?t[0]:t,o=r[0];if(r.length>1)for(var i=1;i<r.length;i++)o=o.union(r[i]);return Array.isArray(e)||(e=[e,e,e]),o.center(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(1);t.mirror=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=t.length>=1&&t[0].length?t[0]:t,s=i[0];if(i.length>1)for(var a=1;a<i.length;a++)s=s.union(i[a]);var l=new r(new o(e[0],e[1],e[2]).unit(),0);return s.mirrored(l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expand=function(e,t,n){return n.expand(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contract=function(e,t,n){return n.contract(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.minkowski=function(){console.log("minkowski() not yet implemented")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(94),o=function(){function e(){this.points=null,this.indices=null}return e.prototype.getIndices=function(){return this.indices},e.prototype.clear=function(){this.indices=null,this.points=null},e.prototype.ccw=function(e,t,n){var r=(this.points[t].x-this.points[e].x)*(this.points[n].y-this.points[e].y)-(this.points[t].y-this.points[e].y)*(this.points[n].x-this.points[e].x);return r<1e-5?0:r},e.prototype.angle=function(e,t){return Math.atan2(this.points[t].y-this.points[e].y,this.points[t].x-this.points[e].x)},e.prototype.distance=function(e,t){return(this.points[t].x-this.points[e].x)*(this.points[t].x-this.points[e].x)+(this.points[t].y-this.points[e].y)*(this.points[t].y-this.points[e].y)},e.prototype.compute=function(e){if(this.indices=null,!(e.length<3)){this.points=e;for(var t=0,n=1;n<this.points.length;n++)this.points[n].y===this.points[t].y?this.points[n].x<this.points[t].x&&(t=n):this.points[n].y<this.points[t].y&&(t=n);var o=[],i=0,s=0;for(n=0;n<this.points.length;n++)n!==t&&((i=this.angle(t,n))<0&&(i+=Math.PI),s=this.distance(t,n),o.push(new r.ConvexHullPoint(n,i,s)));o.sort((function(e,t){return e.compare(t)}));var a,l=new Array(this.points.length+1),u=2;for(n=0;n<this.points.length;n++)n!==t&&(l[u]=o[u-2].index,u++);l[0]=l[this.points.length],l[1]=t;var c=2;for(n=3;n<=this.points.length;n++){for(;this.ccw(l[c-1],l[c],l[n])<=0;)c--;c++,a=l[n],l[n]=l[c],l[c]=a}this.indices=new Array(c);for(n=0;n<c;n++)this.indices[n]=l[n+1]}},e}();t.ConvexHull=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n){this.index=e,this.angle=t,this.distance=n}return e.prototype.compare=function(e){return this.angle<e.angle?-1:this.angle>e.angle?1:this.distance<e.distance?-1:this.distance>e.distance?1:0},e}();t.ConvexHullPoint=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22).union,o=n(40);t.chain_hull=function(e,t){var n=arguments,i=!1,s=0;void 0!==n[s].closed&&(i=n[s++].closed),n[s].length&&(n=n[s]);for(var a=[],l=n.length-(i?0:1),u=0;u<l;u++)a.push(o.hull(n[u],n[(u+1)%n.length]));return r(a)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(41),i=n(16),s=n(9).CSG,a={r:1,fn:32,type:"normal"};t.sphere=function(e){var t=r(r({},a),"number"==typeof e?{r:e}:e),n=t.r,l=t.fn,u=t.center,c=t.type,h=Array.isArray(u)?[+!u[0]*n,+!u[1]*n,+!u[2]*n]:"boolean"!=typeof u||u?[0,0,0]:[n,n,n],f="geodesic"===c?o.geodesicSphere({r:n,fn:l}):s.sphere({radius:n,resolution:l});return h[0]||h[1]||h[2]?i.translate(h,f):f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),o=n(9).CSG;t.cylinder=function(e){var t,n={r:1,r1:1,r2:1,h:1,fn:32,round:!1},i=Object.assign({},n,e),s=i.r1,a=i.r2,l=i.h,u=i.fn,c=i.round,h=[0,0,0],f=arguments;if(e&&e.d&&(s=a=e.d/2),e&&e.r&&(s=e.r,a=e.r),e&&e.h&&(l=e.h),e&&(e.r1||e.r2)&&(s=e.r1,a=e.r2,e.h&&(l=e.h)),e&&(e.d1||e.d2)&&(s=e.d1/2,a=e.d2/2),f&&f[0]&&f[0].length&&(s=(f=f[0])[0],a=f[1],l=f[2],4===f.length&&(u=f[3])),e&&e.start&&e.end)t=c?o.roundedCylinder({start:e.start,end:e.end,radiusStart:s,radiusEnd:a,resolution:u}):o.cylinder({start:e.start,end:e.end,radiusStart:s,radiusEnd:a,resolution:u});else{t=c?o.roundedCylinder({start:[0,0,0],end:[0,0,l],radiusStart:s,radiusEnd:a,resolution:u}):o.cylinder({start:[0,0,0],end:[0,0,l],radiusStart:s,radiusEnd:a,resolution:u});var p=s>a?s:a;e&&e.center&&e.center.length?h=[e.center[0]?0:p,e.center[1]?0:p,e.center[2]?-l/2:0]:e&&!0===e.center?h=[0,0,-l/2]:e&&!1===e.center&&(h=[0,0,0]),t=h[0]||h[1]||h[2]?r.translate(h,t):t}return t}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});n(9).CSG;var o=n(29).circle,i=n(23),s=n(16),a={ri:1,ro:4,fni:16,fno:32,roti:0};t.torus=function(e){var t=r(r({},a),e),n=t.ri,l=t.ro,u=t.fni,c=t.fno,h=t.roti,f=o({r:n,fn:Math.max(3,u),center:!0});return h&&(f=f.rotateZ(h)),i.rotate_extrude({fn:Math.max(3,c)},s.translate([l,0,0],f))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(100);t.color=r.color;var o=n(43);t.css2rgb=o.css2rgb;var i=n(102);t.rgb2hsl=i.rgb2hsl;var s=n(103);t.rgb2html=s.rgb2html;var a=n(104);t.rgb2hsv=a.rgb2hsv;var l=n(105);t.html2rgb=l.html2rgb;var u=n(106);t.hsv2rgb=u.hsv2rgb;var c=n(44);t.hue2rgb=c.hue2rgb;var h=n(107);t.hsl2rgb=h.hsl2rgb},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43);t.color=function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=0,s=n;for("string"==typeof e&&(e=r.css2rgb(e)),Number.isFinite(s[i])&&(e=e.concat(s[i]),i++),Array.isArray(s[i])&&(s=s[i],i=0),t=s[i++];i<s.length;i++)t=t.union(s[i]);return t.setColor(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cssColors3ub={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rgb2hsl=function(e,t,n){Array.isArray(e)&&(n=e[2],t=e[1],e=e[0]);var r,o=Math.max(e,t,n),i=Math.min(e,t,n),s=0,a=(o+i)/2;if(o===i)s=r=0;else{var l=o-i;switch(r=a>.5?l/(2-o-i):l/(o+i),o){case e:s=(t-n)/l+(t<n?6:0);break;case t:s=(n-e)/l+2;break;case n:s=(e-t)/l+4}s/=6}return[s,r,a]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rgb2html=function(e,t,n){return Array.isArray(e)&&(n=e[2],t=e[1],e=e[0]),"#"+Number(16777216+255*e*65536+255*t*256+255*n).toString(16).substring(1,7)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rgb2hsv=function(e,t,n){Array.isArray(e)&&(n=e[2],t=e[1],e=e[0]);var r,o=Math.max(e,t,n),i=Math.min(e,t,n),s=0,a=o,l=o-i;if(r=0===o?0:l/o,o===i)s=0;else{switch(o){case e:s=(t-n)/l+(t<n?6:0);break;case t:s=(n-e)/l+2;break;case n:s=(e-t)/l+4}s/=6}return[s,r,a]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.html2rgb=function(e){var t=0,n=0,r=0;return 7===e.length&&(t=parseInt("0x"+e.slice(1,3),16)/255,n=parseInt("0x"+e.slice(3,5),16)/255,r=parseInt("0x"+e.slice(5,7),16)/255),[t,n,r]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hsv2rgb=function(e,t,n){var r,o,i;Array.isArray(e)&&(n=e[2],t=e[1],e=e[0]);var s=Math.floor(6*e),a=6*e-s,l=n*(1-t),u=n*(1-a*t),c=n*(1-(1-a)*t);switch(s%6){case 0:r=n,o=c,i=l;break;case 1:r=u,o=n,i=l;break;case 2:r=l,o=n,i=c;break;case 3:r=l,o=u,i=n;break;case 4:r=c,o=l,i=n;break;case 5:r=n,o=l,i=u}return[r,o,i]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44);t.hsl2rgb=function(e,t,n){var o,i,s;if(Array.isArray(e)&&(n=e[2],t=e[1],e=e[0]),0===t)o=i=s=n;else{var a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;o=r.hue2rgb(l,a,e+1/3),i=r.hue2rgb(l,a,e),s=r.hue2rgb(l,a,e-1/3)}return[o,i,s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=2*Math.PI;function o(e){return Math.floor(e)}function i(e){return Math.abs(e)}t.sin=function(e){return Math.sin(e/360*r)},t.cos=function(e){return Math.cos(e/360*r)},t.asin=function(e){return Math.asin(e)/360*r},t.acos=function(e){return Math.acos(e)/360*r},t.tan=function(e){return Math.tan(e/360*r)},t.atan=function(e){return Math.atan(e)/360*r},t.atan2=function(e,t){return Math.atan2(e,t)/360*r},t.ceil=function(e){return Math.ceil(e)},t.floor=o,t.abs=i,t.min=function(e,t){return e<t?e:t},t.max=function(e,t){return e>t?e:t},t.rands=function(e,t,n,r){for(var o=new Array(n),i=0;i<n;i++)o[i]=Math.random()*(t-e)+e},t.log=function(e){return Math.log(e)},t.lookup=function(e,t){for(var n=0,r=0;r<t.length;r++){var o=t[r];if(o[0]>=e){o=t[--r];var s=t[r+1],a=0;return o[0]!==s[0]&&(a=i((e-o[0])/(s[0]-o[0]))),n=a>0?o[1]*(1-a)+s[1]*a:o[1]}}return n},t.pow=function(e,t){return Math.pow(e,t)},t.sign=function(e){return e<0?-1:e>1?1:0},t.sqrt=function(e){return Math.sqrt(e)},t.round=function(e){return o(e+.5)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45);t.translateLine=r.translateLine;var o=n(110);t.vector_char=o.vector_char;var i=n(27);t.vectorChar=i.vectorChar;var s=n(28);t.vectorParams=s.vectorParams;var a=n(112);t.vector_text=a.vector_text;var l=n(46);t.vectorText=l.vectorText},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(27);t.vector_char=function(e,t,n){return r.vectorChar({xOffset:e,yOffset:t},n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hersheyFont={height:14,32:[16],33:[10,5,21,5,7,,5,2,4,1,5,0,6,1,5,2],34:[16,4,21,4,14,,12,21,12,14],35:[21,11,25,4,-7,,17,25,10,-7,,4,12,18,12,,3,6,17,6],36:[20,8,25,8,-4,,12,25,12,-4,,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3],37:[24,21,21,3,0,,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7],38:[26,23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2],39:[10,5,19,4,20,5,21,6,20,6,18,5,16,4,15],40:[14,11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7],41:[14,3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7],42:[16,8,21,8,9,,3,18,13,12,,13,18,3,12],43:[26,13,18,13,0,,4,9,22,9],44:[10,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4],45:[26,4,9,22,9],46:[10,5,2,4,1,5,0,6,1,5,2],47:[22,20,25,2,-7],48:[20,9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21],49:[20,6,17,8,18,11,21,11,0],50:[20,4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0],51:[20,5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4],52:[20,13,21,3,7,18,7,,13,21,13,0],53:[20,15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4],54:[20,16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7],55:[20,17,21,7,0,,3,21,17,21],56:[20,8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21],57:[20,16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3],58:[10,5,14,4,13,5,12,6,13,5,14,,5,2,4,1,5,0,6,1,5,2],59:[10,5,14,4,13,5,12,6,13,5,14,,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4],60:[24,20,18,4,9,20,0],61:[26,4,12,22,12,,4,6,22,6],62:[24,4,18,20,9,4,0],63:[18,3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,,9,2,8,1,9,0,10,1,9,2],64:[27,18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,,12,16,10,14,9,11,9,8,10,6,11,5,,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,,19,16,18,8,18,6,19,5],65:[18,9,21,1,0,,9,21,17,0,,4,7,14,7],66:[21,4,21,4,0,,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0],67:[21,18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5],68:[21,4,21,4,0,,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0],69:[19,4,21,4,0,,4,21,17,21,,4,11,12,11,,4,0,17,0],70:[18,4,21,4,0,,4,21,17,21,,4,11,12,11],71:[21,18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,,13,8,18,8],72:[22,4,21,4,0,,18,21,18,0,,4,11,18,11],73:[8,4,21,4,0],74:[16,12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7],75:[21,4,21,4,0,,18,21,4,7,,9,12,18,0],76:[17,4,21,4,0,,4,0,16,0],77:[24,4,21,4,0,,4,21,12,0,,20,21,12,0,,20,21,20,0],78:[22,4,21,4,0,,4,21,18,0,,18,21,18,0],79:[22,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21],80:[21,4,21,4,0,,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10],81:[22,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,,12,4,18,-2],82:[21,4,21,4,0,,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,,11,11,18,0],83:[20,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3],84:[16,8,21,8,0,,1,21,15,21],85:[22,4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21],86:[18,1,21,9,0,,17,21,9,0],87:[24,2,21,7,0,,12,21,7,0,,12,21,17,0,,22,21,17,0],88:[20,3,21,17,0,,17,21,3,0],89:[18,1,21,9,11,9,0,,17,21,9,11],90:[20,17,21,3,0,,3,21,17,21,,3,0,17,0],91:[14,4,25,4,-7,,5,25,5,-7,,4,25,11,25,,4,-7,11,-7],92:[14,0,21,14,-3],93:[14,9,25,9,-7,,10,25,10,-7,,3,25,10,25,,3,-7,10,-7],94:[16,6,15,8,18,10,15,,3,12,8,17,13,12,,8,17,8,0],95:[16,0,-2,16,-2],96:[10,6,21,5,20,4,18,4,16,5,15,6,16,5,17],97:[19,15,14,15,0,,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],98:[19,4,21,4,0,,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3],99:[18,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],100:[19,15,21,15,0,,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],101:[18,3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],102:[12,10,21,8,21,6,20,5,17,5,0,,2,14,9,14],103:[19,15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],104:[19,4,21,4,0,,4,10,7,13,9,14,12,14,14,13,15,10,15,0],105:[8,3,21,4,20,5,21,4,22,3,21,,4,14,4,0],106:[10,5,21,6,20,7,21,6,22,5,21,,6,14,6,-3,5,-6,3,-7,1,-7],107:[17,4,21,4,0,,14,14,4,4,,8,8,15,0],108:[8,4,21,4,0],109:[30,4,14,4,0,,4,10,7,13,9,14,12,14,14,13,15,10,15,0,,15,10,18,13,20,14,23,14,25,13,26,10,26,0],110:[19,4,14,4,0,,4,10,7,13,9,14,12,14,14,13,15,10,15,0],111:[19,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14],112:[19,4,14,4,-7,,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3],113:[19,15,14,15,-7,,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3],114:[13,4,14,4,0,,4,8,5,11,7,13,9,14,12,14],115:[17,14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3],116:[12,5,21,5,4,6,1,8,0,10,0,,2,14,9,14],117:[19,4,14,4,4,5,1,7,0,10,0,12,1,15,4,,15,14,15,0],118:[16,2,14,8,0,,14,14,8,0],119:[22,3,14,7,0,,11,14,7,0,,11,14,15,0,,19,14,15,0],120:[17,3,14,14,0,,14,14,3,0],121:[16,2,14,8,0,,14,14,8,0,6,-4,4,-6,2,-7,1,-7],122:[17,14,14,3,0,,3,14,14,14,,3,0,14,0],123:[14,9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7],124:[8,4,25,4,-7],125:[14,5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7],126:[24,3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(46);t.vector_text=function(e,t,n){return r.vectorText({xOffset:e,yOffset:t},n)}}])}));